<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="zsk">
    <meta name="baidu-site-verification" content="codeva-FDuSf8Qgto" />
    
    <title>
        
            ProtoBufåˆ†æä»¥åŠæŸæ–¹æ•°æ®é€†å‘ |
        
        zskã®blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/logo.svg">
    
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/brands.min.css">
    
        
            
        
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"www.zskkk.cn","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true,"layout":"right"},"style":{"primary_color":"#0066cc","logo":"/images/logo.svg","favicon":"/images/logo.svg","avatar":"/images/head.svg","first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"valine","valine":{"appid":"WxNQs5QEQtykF82Sb7nAjXRO-gzGzoHsz","appkey":"4rZ6NwH5zAu6VEspHwVrgqOq","server_urls":null,"placeholder":"ğŸ˜œ å°½æƒ…åæ§½å§~"},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.21"},"waline":{"server_url":null,"reaction":false,"version":2},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":true,"reward":{"enable":false,"img_link":null,"text":null}},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"version":"3.8.1"}
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"}
    KEEP.language_code_block = {"copy":"å¤åˆ¶ä»£ç ","copied":"å·²å¤åˆ¶","fold":"æŠ˜å ä»£ç å—","folded":"å·²æŠ˜å "}
    KEEP.language_copy_copyright = {"copy":"å¤åˆ¶ç‰ˆæƒä¿¡æ¯","copied":"å·²å¤åˆ¶","title":"åŸæ–‡æ ‡é¢˜","author":"åŸæ–‡ä½œè€…","link":"åŸæ–‡é“¾æ¥"}
  </script>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container border-box">

    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               zskã®blog
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                æ ‡ç­¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                å…³äº
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">æ ‡ç­¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">å…³äº</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">

                

                    <div class="fade-in-down-animation">
    <div class="post-page-container border-box">

        <div class="article-content-container border-box">

            

            <div class="article-content-bottom border-box">
                
                    <div class="article-title">
                        ProtoBufåˆ†æä»¥åŠæŸæ–¹æ•°æ®é€†å‘
                    </div>
                

                
                    <div class="article-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/head.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author">
                                <span class="name">zsk</span>
                                
                                    <span class="author-label">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="article-meta-info-container border-box post">
    <div class="article-meta-info border-box">
        


        
            <span class="meta-info-item article-create-date">
                <i class="icon fa-solid fa-calendar-check"></i>&nbsp;
                <span class="pc">2023-02-01 01:26:14</span>
                <span class="mobile">2023-02-01 01:26</span>
            </span>

            <span class="meta-info-item article-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="pc" data-updated="Wed Feb 01 2023 01:26:14 GMT+0800">2023-02-01 01:26:14</span>
            </span>
        

        

        
            <span class="article-tag meta-info-item border-box">
                <i class="icon fas fa-tags"></i>&nbsp;
                <ul>
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/js/">js</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/protobuf/">protobuf</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item article-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>4.8k å­—</span>
            </span>
        
        
            <span class="meta-info-item article-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>21 åˆ†é’Ÿ</span>
            </span>
        
        
            <span class="meta-info-item article-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="article-content keep-markdown-body">
                    
                        <div class="article-aging-tips"
                             data-update-date="Wed Feb 01 2023 01:26:14 GMT+0800"
                             data-aging-days="365"
                        >
                            <i class="fa-solid fa-circle-exclamation"></i>æœ¬æ–‡è·ç¦»ä¸Šæ¬¡æ›´æ–°å·²è¿‡å» <span class="days">0</span> å¤©ï¼Œéƒ¨åˆ†å†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ï¼Œè¯·æ³¨æ„ç”„åˆ«ã€‚
                        </div>
                    

                    <h3 id="ä»€ä¹ˆæ˜¯protobuf"><a href="#ä»€ä¹ˆæ˜¯protobuf" class="headerlink" title="ä»€ä¹ˆæ˜¯protobuf"></a>ä»€ä¹ˆæ˜¯protobuf</h3><p>ä¸€æ‹¿åˆ°ç½‘ç«™ï¼ŒF12æŸ¥çœ‹æ˜¯å¦æœ‰ç›¸å…³æ•°æ®çš„è¯·æ±‚æ¥å£<br />è¯·æ±‚ä½“æ˜¯è¿™æ ·çš„<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/01.webp"
                     
                ><br /><br>è¯·æ±‚å¤´çš„ç±»å‹ä¹Ÿéå¸¸è§çš„<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/02.webp"
                     
                ></p>
<ul>
<li>application&#x2F;jsonï¼š JSONæ•°æ®æ ¼å¼</li>
<li>application&#x2F;octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®</li>
<li>application&#x2F;x-www-form-urlencoded ï¼š ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey&#x2F;valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰</li>
<li>multipart&#x2F;form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼</li>
</ul>
<p>é€šè¿‡æŸ¥è¯¢çŸ¥é“è¿™æ˜¯protobuf<br />å‚è€ƒæ–‡ç« ï¼š<a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/dideng7039/article/details/101869819" >https://blog.csdn.net/dideng7039/article/details/101869819<i class="fas fa-external-link-alt"></i></a><br />æ€»ç»“åœ¨å›¾ä¸‹äº†<br /><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/03.webp"
                     
                ></p>
<h3 id="é‚£å¦‚ä½•ä½¿ç”¨protobufï¼Ÿ"><a href="#é‚£å¦‚ä½•ä½¿ç”¨protobufï¼Ÿ" class="headerlink" title="é‚£å¦‚ä½•ä½¿ç”¨protobufï¼Ÿ"></a>é‚£å¦‚ä½•ä½¿ç”¨protobufï¼Ÿ</h3><p>å¼€å‘è€…éœ€è¦å…ˆç¼–å†™protoæ–‡ä»¶ï¼Œåœ¨protoæ–‡ä»¶ä¸­ç¼–å†™é¢„æœŸçš„æ•°æ®ç±»å‹ã€æ•°æ®å­—æ®µã€é»˜è®¤å€¼ç­‰<br />ç„¶åï¼Œé€šè¿‡ç¼–è¯‘å™¨ç”Ÿæˆï¼Œç¼–ç¨‹è¯­è¨€å¯¹åº”çš„å¼€å‘åŒ…ï¼å¼€å‘æ—¶è°ƒå¼€å‘åŒ…ä¸­çš„å¯¹åº”æ–¹æ³•è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚<br /><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/04.webp"
                     
                ><br /><br>æ‰€ä»¥è¯·æ±‚çš„æ—¶å€™éœ€è¦å‚æ•°æ˜¯åºåˆ—åŒ–çš„å­—èŠ‚åºåˆ—ï¼Œå¯¹æ¥æ”¶åˆ°çš„è¿”å›å€¼è¿›è¡Œååºåˆ—åŒ–<br />è€Œè¦å®ç°åºåˆ—åŒ–ï¼Œå°±å¿…é¡»è¦æœ‰å¼€å‘åŒ…ï¼Œå¯æ˜¯å¼€å‘åŒ…æ˜¯jsç‰ˆæœ¬çš„ã€‚è€Œå¼€å‘åŒ…æ˜¯ç”±protoç¼–è¯‘è€Œæ¥ï¼Œåªè¦èƒ½æ‹¿åˆ°protoæ–‡ä»¶ï¼Œå°±å¯ä»¥ç¼–è¯‘æˆä»»æ„ç¼–ç¨‹çš„è¯­è¨€ç‰ˆæœ¬ã€‚<br />é‚£å°±æ˜¯éœ€è¦é€šè¿‡ç¼–è¯‘å¥½çš„åŒ…åç¼–è¯‘å‡ºprotoï¼Œå†ç¼–è¯‘ä¸ºpythonç‰ˆæœ¬çš„</p>
<p>è¿™é‡Œå…ˆå†™ä¸€ä¸ªç®€å•protoï¼Œåœ¨ç¼–è¯‘æˆjsç‰ˆæœ¬ï¼Œçœ‹çœ‹é‡Œé¢å¤§æ¦‚çš„ç»“æ„é•¿ä»€ä¹ˆæ ·<br />ä¸‹è½½ç¼–è¯‘å™¨ï¼š<a class="link"   target="_blank" rel="noopener" href="https://github.com/protocolbuffers/protobuf/releases/" >https://github.com/protocolbuffers/protobuf/releases/<i class="fas fa-external-link-alt"></i></a><br />è§£å‹åæŠŠbinç›®å½•è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼Œå°±å¯ä»¥å…¨å±€ä½¿ç”¨<br />æ³¨æ„ï¼Œä¸‹è½½ä½äº3.21.0 çš„protoç‰ˆæœ¬ï¼Œå› ä¸ºåŸé¡¹ç›®å·²å°†å®ƒç‹¬ç«‹å‡ºæ¥ï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„protocï¼Œè¿è¡Œjs_outä¼šç¼ºå°‘æ’ä»¶<br />protoé™¤äº†ä¸€äº›åŸºç¡€å­—æ®µï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šå­—æ®µ</p>
<table>
<thead>
<tr>
<th><strong>è‹±æ–‡</strong></th>
<th><strong>ä¸­æ–‡</strong></th>
<th><strong>å¤‡æ³¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td>enum</td>
<td>æšä¸¾(æ•°å­—ä»é›¶å¼€å§‹) ä½œç”¨æ˜¯ä¸ºå­—æ®µæŒ‡å®šæŸâ€é¢„å®šä¹‰å€¼åºåˆ—â€</td>
<td>enum Type {DEFAULT &#x3D; 0;success &#x3D; 1; fail&#x3D; -1;}</td>
</tr>
<tr>
<td>message</td>
<td>æ¶ˆæ¯ä½“</td>
<td>message Student{}</td>
</tr>
<tr>
<td>repeated</td>
<td>æ•°ç»„&#x2F;é›†åˆ</td>
<td>repeated Student student &#x3D; 1</td>
</tr>
<tr>
<td>import</td>
<td>å¯¼å…¥å®šä¹‰</td>
<td>import â€œprotos&#x2F;other_protos.protoâ€</td>
</tr>
<tr>
<td>&#x2F;&#x2F;</td>
<td>æ³¨é‡Š</td>
<td>&#x2F;&#x2F;ç”¨äºæ³¨é‡Š</td>
</tr>
<tr>
<td>extend</td>
<td>æ‰©å±•</td>
<td>extend Student {}</td>
</tr>
<tr>
<td>package</td>
<td>åŒ…å</td>
<td>ç›¸å½“äºå‘½åç©ºé—´ï¼Œç”¨æ¥é˜²æ­¢ä¸åŒæ¶ˆæ¯ç±»å‹çš„æ˜æ˜å†²çª</td>
</tr>
</tbody></table>
<p>ç°åœ¨å†™ä¸€ä¸ªç®€å•çš„protoæ–‡ä»¶</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>; <span class="comment">// å®šä¹‰protoçš„ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum </span><span class="title class_">Gender</span>&#123;</span><br><span class="line">  boy=<span class="number">0</span>;</span><br><span class="line">  girl=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum </span><span class="title class_">Score</span>&#123;</span><br><span class="line">  DEFAULT = <span class="number">0</span>;</span><br><span class="line">  success = <span class="number">1</span>; <span class="comment">// åŠæ ¼</span></span><br><span class="line">  fail = -<span class="number">1</span>; <span class="comment">// ä¸åŠæ ¼</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">message </span><span class="title class_">Student</span> &#123;</span><br><span class="line">  <span class="type">string</span> name = <span class="number">1</span>; <span class="comment">// å§“å</span></span><br><span class="line">  <span class="type">int32</span> age = <span class="number">2</span>; <span class="comment">// å¹´é¾„</span></span><br><span class="line">  Gender gender = <span class="number">3</span>; <span class="comment">//æ€§åˆ«</span></span><br><span class="line">  <span class="keyword">message </span><span class="title class_">Subject</span> &#123;</span><br><span class="line">    <span class="type">string</span> name = <span class="number">1</span>; <span class="comment">// å­¦ç§‘åç§°</span></span><br><span class="line">    Score score = <span class="number">2</span>; <span class="comment">// åˆ†æ•°</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">repeated</span> Subject subject = <span class="number">4</span>; <span class="comment">// å­¦ç§‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘ä¸ºJSåŒ…</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">protoc --js_out=. .\test.proto3</span><br><span class="line">protoc --js_out=import_style=commonjs,binary:. test.proto</span><br></pre></td></tr></table></figure>
<p>ä¸¤æ¡è¯­å¥éƒ½å¯ä»¥ï¼Œç¬¬ä¸€æ¡ä¼šæ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œç¬¬äºŒæ¡æ˜¯åˆå¹¶æˆä¸€ä¸ªï¼Œæ¨èä½¿ç”¨ç¬¬äºŒæ¡<br />å¤´éƒ¨å°±èƒ½çœ‹åˆ°å®šä¹‰å¥½çš„å‡ ä¸ªå¤§çš„å¯¹è±¡<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/05.webp"
                     
                ><br />å¯ä»¥å¤§æ¦‚çœ‹ä¸‹ä»£ç ï¼Œæˆªä¸€æ®µæ¯”è¾ƒé‡è¦çš„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Serializes the given message to binary data (in protobuf wire</span></span><br><span class="line"><span class="comment"> * format), writing to the given BinaryWriter.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">!proto.Student</span>&#125; <span class="variable">message</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">!jspb.BinaryWriter</span>&#125; <span class="variable">writer</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@suppress</span> &#123;<span class="type">unusedLocalVariables</span>&#125; f is only used for nested messages</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">proto.<span class="property">Student</span>.<span class="property">serializeBinaryToWriter</span> = <span class="keyword">function</span>(<span class="params">message, writer</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> f = <span class="literal">undefined</span>;</span><br><span class="line">  f = message.<span class="title function_">getName</span>();</span><br><span class="line">  <span class="keyword">if</span> (f.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    writer.<span class="title function_">writeString</span>(</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      f</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  f = message.<span class="title function_">getAge</span>();</span><br><span class="line">  <span class="keyword">if</span> (f !== <span class="number">0</span>) &#123;</span><br><span class="line">    writer.<span class="title function_">writeInt32</span>(</span><br><span class="line">      <span class="number">2</span>,</span><br><span class="line">      f</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  f = message.<span class="title function_">getGender</span>();</span><br><span class="line">  <span class="keyword">if</span> (f !== <span class="number">0.0</span>) &#123;</span><br><span class="line">    writer.<span class="title function_">writeEnum</span>(</span><br><span class="line">      <span class="number">3</span>,</span><br><span class="line">      f</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  f = message.<span class="title function_">getSubjectList</span>();</span><br><span class="line">  <span class="keyword">if</span> (f.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    writer.<span class="title function_">writeRepeatedMessage</span>(</span><br><span class="line">      <span class="number">4</span>,</span><br><span class="line">      f,</span><br><span class="line">      proto.<span class="property">Student</span>.<span class="property">Subject</span>.<span class="property">serializeBinaryToWriter</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€æ®µåºåˆ—åŒ–çš„ä»£ç ä¸­å‡ºç°äº†å¦‚ä¸‹çš„æ–¹æ³•åï¼š</p>
<blockquote>
<p>getName, writeString<br>getAge, writeInt32<br>getGender, writeEnum<br>getSubjectList, writeRepeatedMessage</p>
</blockquote>
<p>è¿™ä¸€æ•´ä¸ªåˆ¤æ–­ï¼Œè¿™æ„å‘³ Studentä¸­å®šä¹‰äº†å››ä¸ªæ•°æ®å˜é‡ï¼Œ åºå·ä¸º1ï¼Œ 2ï¼Œ3ï¼Œ4ï¼Œè€Œæ•°æ®ç±»å‹å’Œå˜é‡åå¯ä»¥æ ¹æ®å…¶è°ƒç”¨çš„æ–¹æ³•æ¨å‡º</p>
<blockquote>
<p>åºå·ä¸º1çš„æ•°æ®ç±»å‹ä¸ºStringï¼Œå˜é‡åä¸ºname<br>åºå·ä¸º2çš„æ•°æ®ç±»å‹ä¸ºInt32ï¼Œå˜é‡åä¸ºage<br>åºå·ä¸º3çš„æ•°æ®ç±»å‹ä¸ºEnumï¼Œ å˜é‡åä¸ºgender<br>åºå·ä¸º4çš„æ•°æ®ç±»å‹ä¸ºMessageï¼Œå˜é‡åä¸ºsubjectï¼ŒRepeatedä¸‹é¢è®²</p>
</blockquote>
<p>å­—ç¬¦ä¸²å’Œæ•´æ•°å‹ä¸€çœ‹å°±æ˜äº†ï¼Œä¸åšè¿‡å¤šè§£é‡Šï¼Œä¸‹é¢äº†è§£<font color="red">Message</font>å’Œ<font color="red">Enum</font><br /><strong>Messageæ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿ</strong><br />ç®€å•çš„ç†è§£ï¼Œå¯ä»¥æŠŠmessageçœ‹ä½œæ˜¯ä¸€ä¸ªç±»ï¼Œåœ¨å…¶ä¸­å®šä¹‰çš„å˜é‡å°±æ˜¯ç±»å±æ€§<br />åœ¨åºå·ä¸º4çš„subjectåˆ¤æ–­ä¸­æœ‰è¿™æ ·ä¸€è¡Œä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proto.Student.Subject.serializeBinaryToWriter</span><br></pre></td></tr></table></figure>
<p>å†æ¥çœ‹çœ‹Studentçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proto.Student.serializeBinaryToWriter</span><br></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œå¯çŸ¥ï¼ŒSubjectå®šä¹‰åœ¨Studenté‡Œé¢ä¸”ç±»å‹æ˜¯Message<br />åœ¨å®šä¹‰åºå·ä¸º4çš„æ•°æ®æ—¶ï¼Œæ•°æ®ç±»å‹å°±æ˜¯Subjectï¼Œå¹¶ä¸”æ˜¯å¯é‡å¤çš„ï¼<br />æ‰€ä»¥æ‰ä¼šå‡ºç°è¿™æ ·ä¸€ä¸ªæ–¹æ³•writeRepeatedMessageï¼Œå¹¶ä¸”ä¸¥æ ¼æ¥è¯´ï¼Œåºå·ä¸º4çš„æ•°æ®æ˜¯è‡ªå®šä¹‰çš„Messageæ•°æ®ç±»å‹ï¼Œä¸”æ˜¯å¯é‡å¤çš„<br /><font color="red">Message</font>ç±»å‹çš„Subjectè¢«<font color="red">repeated</font>ä¿®é¥°ï¼Œå³Subjectæ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªSubjectå®ä¾‹çš„æ•°ç»„<br /><strong>Enumæ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿ</strong><br />æšä¸¾ç±»å‹ï¼Œåœ¨å€¼ä¸ºé™å®šçš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚æ€§åˆ«é™¤äº†ç”·å°±æ˜¯å¥³ã€‚å¯ä»¥ç†è§£ä¸ºå•é€‰æ¡†ï¼Œè¿™é‡Œè¿˜æœ‰ä¸ªæ³¨æ„çš„ï¼Œæšä¸¾ç±»å‹ã€‚<font color="red">å¿…é¡»è¦æœ‰ä¸º0çš„é»˜è®¤é€‰é¡¹</font><br />æ€»è€Œè¨€ä¹‹å‘¢ï¼Œçœ‹è§<font color="red">writeEnum</font>å°±çŸ¥é“è¿™ä¸ªæ•°æ®ä¸º<font color="red">Enumç±»å‹</font><br /><font color="red">repeated</font>ä¹Ÿå¯ä»¥ä¿®é¥°<font color="red">Enum</font>ï¼Œå…¶å¯¹åº”çš„JSå†™æ“ä½œçš„æ–¹æ³•ä¸º<font color="red">writePackedEnum</font><br />è¢«repeatedä¿®é¥°çš„enumç±»å‹ï¼Œ<font color="red">åˆ™å¥½ä¼¼çš„å¤šé€‰æ¡†ï¼Œè‡³å°‘é€‰æ‹©ä¸€ä¸ªï¼Œå¯é€‰æ‹©å¤šä¸ª</font><br /><strong>å°ç»“ä¸€ä¸‹ï¼š</strong><br /><font color="red">è¢«repeatedä¿®é¥°çš„messageç±»å‹çš„æ•°æ®ï¼Œçœ‹ä½œæ˜¯ä¸€ä¸ªåŒ…å«ä»»æ„ä¸ªæŸmessageç±»å‹æ•°æ®çš„æ•°ç»„</font><br /><font color="red">è¢«repeatedä¿®é¥°çš„enumç±»å‹çš„æ•°æ®ï¼Œçœ‹ä½œæ˜¯ä¸€ä¸ªåŒ…å«ä»»æ„ä¸ªæ•´æ•°ç±»å‹æ•°æ®çš„æ•´å‹æ•°ç»„</font></p>
<h3 id="è°ƒè¯•JSåå†™proto"><a href="#è°ƒè¯•JSåå†™proto" class="headerlink" title="è°ƒè¯•JSåå†™proto"></a>è°ƒè¯•JSåå†™proto</h3><p>ç›®æ ‡ç½‘ç«™ï¼šaHR0cHM6Ly9zLndhbmZhbmdkYXRhLmNvbS5jbi9wYXBlcj9xPXB5dGhvbg&#x3D;&#x3D;<br />å°†æ¥å£çš„è¯·æ±‚åœ°å€å¤åˆ¶ &#x2F;SearchService.SearchService&#x2F;search ï¼Œæ‰“ XHR&#x2F;fetch æ–­ç‚¹<br />æ–­ä½åæŸ¥çœ‹å †æ ˆï¼Œæœ‰SearchServiceè·Ÿè¿›å»æ‰“æ–­ç‚¹çœ‹çœ‹<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/06.webp"
                     
                ><br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/07.webp"
                     
                ><br />çœ‹ä¸‹è¿™äº›æ–¹æ³•çš„å‘½åï¼Œåºåˆ—åŒ–ï¼ˆserializeï¼‰ã€ååºåˆ—åŒ–ï¼ˆdeserializeï¼‰ï¼ŒåŸºæœ¬æ–­å®šå°±åœ¨è¿™ä¸ªjsæ–‡ä»¶é‡Œï¼Œä½†æ˜¯è¿™ä¸ªjsæœ‰å‡ ä¸‡è¡Œä»£ç ï¼Œä¸å¯èƒ½ä»”ç»†å»çœ‹ä¹Ÿæ²¡å¿…è¦ã€‚<br />çœ‹åˆ°æ˜æ˜¾çš„prototypeå­—æ ·ï¼Œç›´æ¥æœprotoçš„ç‰¹å¾</p>
<blockquote>
<p><strong><font color="red">toObject å°†è·å–åˆ°çš„æ•°æ®è½¬æˆç»“æ„åŒ–æ•°æ®</font></strong><br><strong><font color="red">deserializeBinary äºŒè¿›åˆ¶æ•°æ®è½¬æ¢æˆæ•°ç»„ç»“æ„ï¼ˆååºåˆ—åŒ– | è·å–åˆ°çš„æ•°æ®éœ€è¦Uint8Arrayè½¬æˆäºŒè¿›åˆ¶ï¼‰</font></strong><br><strong><font color="red">deserializeBinaryFromReader æ ¹æ®è§„åˆ™ï¼Œå°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢æˆæ•°ç»„ç»“æ„</font></strong><br><strong><font color="red">serializeBinary å°†æ•°æ®è½¬æˆäºŒè¿›åˆ¶ï¼ˆåºåˆ—åŒ–ï¼‰</font></strong><br><strong><font color="red">serializeBinaryToWriter æ ¹æ®è§„åˆ™ï¼Œå°†æ•°æ®è½¬æ¢æˆäºŒè¿›åˆ¶æ•°æ®ï¼ˆåºåˆ—åŒ–ï¼‰</font></strong></p>
</blockquote>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/08.webp"
                     
                ><br />å¯ä»¥è‚¯å®šå°±æ˜¯protoäº†<br />ä¸€æ­¥æ­¥è·Ÿè¿›åï¼Œåˆ°åºåˆ—åŒ–å‘åŒ…çš„ä½ç½®<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/09.webp"
                     
                ><br />åœ¨è¿™é‡Œï¼Œç›´æ¥å°±å¯ä»¥çœ‹å‡ºå…¶åŸºæœ¬ç»“æ„</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">message </span><span class="title class_">SearchService</span> &#123;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">SearchRequest</span> &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­è°ƒè¯•ã€‚<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/10.webp"
                     
                ><br />è¿™é‡Œå¯ä»¥çœ‹å‡ºSearchRequestå®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯åºå·ä¸º1çš„messageç±»å‹çš„CommonRequestå’Œåºå·ä¸º2çš„enumç±»å‹çš„InterfaceTypeã€‚<br />æ ¹æ®SearchService.CommonRequestå¯çŸ¥ï¼ŒCommonRequestå®šä¹‰åœ¨SearchServiceä¸­<br />æ‰€ä»¥ï¼Œprotoæ–‡ä»¶ç°åœ¨æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>; <span class="comment">// å®šä¹‰protoçš„ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">message </span><span class="title class_">SearchService</span> &#123;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">SearchRequest</span> &#123;</span><br><span class="line">    CommonRequest commonRequest = <span class="number">1</span>; <span class="comment">// ä»»æ„å˜é‡å</span></span><br><span class="line">    InterfaceType interfaceType = <span class="number">2</span>; <span class="comment">// ä»»æ„å˜é‡å</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">CommonRequest</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">InterfaceType</span>&#123;</span><br><span class="line">    DEFAULT = <span class="number">0</span>;  <span class="comment">// å®šä¹‰äº†ä»€ä¹ˆä¸çŸ¥é“ï¼Œä½†æ˜¯enumå¿…é¡»æœ‰ä¸€ä¸ªå€¼å°±æ˜¯0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font color="red">å…³äºå˜é‡åæ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ªå…¶å®ä¸é‡è¦</font><br />ç»§ç»­å¾€ä¸‹è°ƒè¯•ï¼Œè¿›å…¥åˆ°äº†CommonRequest<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/11.webp"
                     
                ><br />æ ¹æ®æ–¹æ³•åï¼Œç›´æ¥å°±å¯ä»¥åå†™å‡ºCommonRequest</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">message </span><span class="title class_">SearchRequest</span> &#123;</span><br><span class="line">    CommonRequest commonRequest = <span class="number">1</span>; <span class="comment">// ä»»æ„å˜é‡å</span></span><br><span class="line">    InterfaceType interfaceType = <span class="number">2</span>; <span class="comment">// ä»»æ„å˜é‡å</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">CommonRequest</span> &#123;</span><br><span class="line">    <span class="type">string</span> searchType = <span class="number">1</span>;</span><br><span class="line">    <span class="type">string</span> searchWord = <span class="number">2</span>;</span><br><span class="line">    SearchSort searchSort = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">repeated</span> Second second = <span class="number">4</span>;</span><br><span class="line">    <span class="type">int32</span> currentPage = <span class="number">5</span>;</span><br><span class="line">    <span class="type">int32</span> pageSize = <span class="number">6</span>;</span><br><span class="line">    SearchScope searchScope = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">repeated</span> SearchFilter searchFilter = <span class="number">8</span>;</span><br><span class="line">    <span class="type">bool</span> languageExpand = <span class="number">9</span>;</span><br><span class="line">    <span class="type">bool</span> topicExpand = <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">SearchSort</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">Second</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">InterfaceType</span>&#123;</span><br><span class="line">    TypeDefault = <span class="number">0</span>;  <span class="comment">// å®šä¹‰äº†ä»€ä¹ˆä¸çŸ¥é“ï¼Œä½†æ˜¯enumå¿…é¡»æœ‰ä¸€ä¸ªå€¼å°±æ˜¯0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">SearchScope</span>&#123;</span><br><span class="line">    ScopeDefault = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">SearchFilter</span> &#123;</span><br><span class="line">      FilterDefault = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SearchSortå’ŒSecondéƒ½æ˜¯åœ¨SearchServiceå®šä¹‰çš„ï¼ŒCtrl + Fæœç´¢<br />SearchService.SearchSort.serializeBinaryToWriter<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/12.webp"
                     
                ><br />SearchService.Second.serializeBinaryToWriter<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/13.webp"
                     
                ><br />è¡¥é½å­—æ®µï¼Œè¯·æ±‚æ¥å£çš„protoæ–‡ä»¶å°±ç®—å†™å®Œäº†</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>; <span class="comment">// å®šä¹‰protoçš„ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">message </span><span class="title class_">SearchService</span> &#123;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">SearchRequest</span> &#123;</span><br><span class="line">    CommonRequest commonRequest = <span class="number">1</span>; <span class="comment">// ä»»æ„å˜é‡å</span></span><br><span class="line">    InterfaceType interfaceType = <span class="number">2</span>; <span class="comment">// ä»»æ„å˜é‡å</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">CommonRequest</span> &#123;</span><br><span class="line">    <span class="type">string</span> searchType = <span class="number">1</span>;</span><br><span class="line">    <span class="type">string</span> searchWord = <span class="number">2</span>;</span><br><span class="line">    SearchSort searchSort = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">repeated</span> Second second = <span class="number">4</span>;</span><br><span class="line">    <span class="type">int32</span> currentPage = <span class="number">5</span>;</span><br><span class="line">    <span class="type">int32</span> pageSize = <span class="number">6</span>;</span><br><span class="line">    SearchScope searchScope = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">repeated</span> SearchFilter searchFilter = <span class="number">8</span>;</span><br><span class="line">    <span class="type">bool</span> languageExpand = <span class="number">9</span>;</span><br><span class="line">    <span class="type">bool</span> topicExpand = <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">SearchSort</span> &#123;</span><br><span class="line">    <span class="type">string</span> field = <span class="number">1</span>;</span><br><span class="line">    Order order = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">enum </span><span class="title class_">Order</span> &#123;</span><br><span class="line">      OrderDefault = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">message </span><span class="title class_">Second</span> &#123;</span><br><span class="line">    <span class="type">string</span> field = <span class="number">1</span>;</span><br><span class="line">    <span class="type">string</span> value = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">InterfaceType</span>&#123;</span><br><span class="line">    TypeDefault = <span class="number">0</span>;  <span class="comment">// å®šä¹‰äº†ä»€ä¹ˆä¸çŸ¥é“ï¼Œä½†æ˜¯enumå¿…é¡»æœ‰ä¸€ä¸ªå€¼å°±æ˜¯0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">SearchScope</span>&#123;</span><br><span class="line">    ScopeDefault = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">SearchFilter</span> &#123;</span><br><span class="line">    FilterDefault = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font color="red">å¯¹äºæ‰€æœ‰çš„enumæšä¸¾ç±»ï¼Œè‡³å°‘å¡«å……ä¸€ä¸ªé»˜è®¤å€¼0ï¼Œä¸”å˜é‡åå”¯ä¸€</font><br />æœ‰çš„æƒ…å†µï¼Œæšä¸¾ç±»å«æœ‰å“ªäº›å­—æ®µï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ç›´æ¥çœ‹åˆ°ï¼Œå°±ç…§æŠ„å†™è¿›å»ã€‚<br />çœ‹ä¸åˆ°çš„ï¼Œç»™ä¸ªå”¯ä¸€å˜é‡åï¼Œé»˜è®¤å€¼ä¸º0å³å¯<br />ç°åœ¨è¿˜å·®ä¸€ä¸ªæºæ•°æ®ï¼Œå³æˆ‘ä»¬éœ€è¦çŸ¥é“å¾…ç¼–è¯‘çš„æºæ•°æ®æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ<br />ä½¿ç”¨fiddlerè¿›è¡ŒæŠ“åŒ…æŸ¥çœ‹è¯·æ±‚å‚æ•°<br />æŠ“åˆ°åŒ…åæŸ¥çœ‹HexViewï¼Œé»‘è‰²éƒ¨åˆ†å°±æ˜¯è¯·æ±‚ä½“ï¼Œé‡Œé¢ä¹Ÿå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœç´ çš„å…³é”®è¯python<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/14.webp"
                     
                ><br />é€‰ä¸­ï¼Œå³é”®ä¿å­˜ä¸ºå­—èŠ‚æ–‡ä»¶ä¹Ÿå°±æ˜¯binåç¼€ï¼Œè¿™é‡Œè¦æ³¨æ„ï¼Œå‰5ä¸ªå­—èŠ‚è¡¨ç¤ºè¯·æ±‚ä½“çš„é•¿åº¦ï¼Œä»ç¬¬6ä¸ªå­—èŠ‚å¼€å§‹åˆ°ç»“æŸåˆšå¥½å°±æ˜¯0x1A<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/15.webp"
                     
                ><br /><font color="red">å­—èŠ‚æ•°æ®æ˜¯å¯ä»¥é€šè¿‡protocç¼–è¯‘å™¨è§£ç å‡ºæ¥çš„</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;protoc --decode_raw &lt; get_req.bin</span><br><span class="line">1 &#123;</span><br><span class="line">  1: &quot;paper&quot;</span><br><span class="line">  2: &quot;python&quot;</span><br><span class="line">  5: 2</span><br><span class="line">  6: 20</span><br><span class="line">  8: &quot;\000&quot;</span><br><span class="line">&#125;</span><br><span class="line">2: 1</span><br></pre></td></tr></table></figure>
<p>ä¸ä¸Šé¢ç¼–å†™å¥½çš„protoæ–‡ä»¶è¿›è¡Œå¯¹æ¯”<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/16.webp"
                     
                ><br />åƒæœ‰äº›æ²¡åŒ…å«åˆ°çš„å­—æ®µï¼Œæ˜¯è¯·æ±‚çš„æ—¶å€™é¡µé¢æ²¡åšä¸€äº›æ¡ä»¶ç­›é€‰ï¼Œå°±æ²¡è§¦å‘åˆ°æŸäº›å­—æ®µ<br />å®é™…ä¼ è¾“æ—¶ï¼Œç®€å•çš„çœ‹ï¼Œé”®å°±æ˜¯protoä¸­å®šä¹‰çš„åºå·ï¼Œè¿™å°±æ˜¯ä¹‹å‰æåˆ°çš„ å˜é‡åæ˜¯ä»€ä¹ˆæ ¹æœ¬ä¸é‡è¦ï¼Œå˜é‡ååªæ˜¯æ–¹ä¾¿å¼€å‘è€…å¼€å‘æ—¶ä¾¿äºç†è§£ä¸è°ƒç”¨ã€‚ï¼ˆä¼ è¾“ä¸€ä¸ªæ•°å­—è¿œæ¯”ä¼ è¾“ä¸€ä¸ªå­—ç¬¦ä¸²æ›´æœ‰æ•ˆç‡ï¼‰<br />å®Œå…¨è¿˜åŸprotoæ–‡ä»¶æ˜¯ä¸éœ€è¦çš„ï¼Œæ„é€ å‡ºè¿™ä¸ªè¯·æ±‚å‚æ•°ï¼Œè·å–è¿™ä¸ªæ¥å£çš„å“åº”å†…å®¹å°±å¯ä»¥äº†</p>
<h3 id="å®ç°è¯·æ±‚"><a href="#å®ç°è¯·æ±‚" class="headerlink" title="å®ç°è¯·æ±‚"></a>å®ç°è¯·æ±‚</h3><p>ç¼–è¯‘protoä¸ºpythonåŒ…ï¼Œæ„å»ºå‚æ•°ï¼Œåºåˆ—åŒ–å‚æ•°ï¼Œå‘é€è¯·æ±‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc --python_out=. ./search.proto</span><br></pre></td></tr></table></figure>
<p>ç›®å½•ä¸‹ç”Ÿæˆäº†search_pb2.py æ‹–å…¥é¡¹ç›®ä¸­ï¼Œéœ€è¦ä½¿ç”¨æ—¶å°±è°ƒç”¨å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> search_pb2 <span class="keyword">as</span> pb  <span class="comment"># å¯¼å…¥åŒ…</span></span><br><span class="line"></span><br><span class="line">search_request = pb.SearchService.SearchRequest()  <span class="comment"># å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment"># æŒ‰ä¸Šé¢è§£ææ•°æ®ï¼ŒæŒ‰ç…§å¯¹åº”çš„å±æ€§è®¾ç½®å€¼</span></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²ï¼Œæ•°å­—å‹çš„éƒ½æ˜¯ç›´æ¥èµ‹å€¼</span></span><br><span class="line">search_request.commonRequest.searchType = <span class="string">&#x27;paper&#x27;</span></span><br><span class="line">search_request.commonRequest.searchWord = <span class="string">&#x27;python&#x27;</span></span><br><span class="line">search_request.commonRequest.currentPage = <span class="number">2</span></span><br><span class="line">search_request.commonRequest.pageSize = <span class="number">20</span></span><br><span class="line"><span class="comment"># repeatedä¿®é¥°çš„messsageç±»å‹å’Œenumç±»å‹ï¼Œåˆ™éœ€è¦ç¨å¾®å¤šå‡ ä¸ªæ­¥éª¤</span></span><br><span class="line">search_request.commonRequest.searchFilter.append(<span class="number">0</span>)</span><br><span class="line">search_request.interfaceType = <span class="number">1</span></span><br><span class="line">form_data = search_request.SerializeToString()</span><br><span class="line"><span class="built_in">print</span>(form_data)</span><br><span class="line"><span class="comment"># ä¿å­˜æ•°æ®ç®binæ–‡ä»¶ä¾›åç»­å¯¹æ¯”ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;me.bin&#x27;</span>, mode=<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(form_data)</span><br><span class="line"><span class="built_in">print</span>(search_request.SerializeToString().decode())</span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œè¯·æ±‚å‚æ•°çš„åºåˆ—åŒ–å·²ç»æ˜¯å®Œæˆäº†<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/17.webp"
                     
                ><br />å‘é€è¯·æ±‚å®Œæ•´ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> search_pb2 <span class="keyword">as</span> pb  <span class="comment"># å¯¼å…¥åŒ…</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">search_request = pb.SearchService.SearchRequest()  <span class="comment"># å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment"># æŒ‰ä¸Šé¢è§£ææ•°æ®ï¼ŒæŒ‰ç…§å¯¹åº”çš„å±æ€§è®¾ç½®å€¼</span></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²ï¼Œæ•°å­—å‹çš„éƒ½æ˜¯ç›´æ¥èµ‹å€¼</span></span><br><span class="line">search_request.commonRequest.searchType = <span class="string">&#x27;paper&#x27;</span></span><br><span class="line">search_request.commonRequest.searchWord = <span class="string">&#x27;python&#x27;</span></span><br><span class="line">search_request.commonRequest.currentPage = <span class="number">2</span></span><br><span class="line">search_request.commonRequest.pageSize = <span class="number">20</span></span><br><span class="line"><span class="comment"># repeatedä¿®é¥°çš„messsageç±»å‹å’Œenumç±»å‹ï¼Œåˆ™éœ€è¦ç¨å¾®å¤šå‡ ä¸ªæ­¥éª¤</span></span><br><span class="line">search_request.commonRequest.searchFilter.append(<span class="number">0</span>)</span><br><span class="line">search_request.interfaceType = <span class="number">1</span></span><br><span class="line">form_data = search_request.SerializeToString()</span><br><span class="line"><span class="built_in">print</span>(form_data)</span><br><span class="line"><span class="comment"># ä¿å­˜æ•°æ®ç®binæ–‡ä»¶ä¾›åç»­å¯¹æ¯”ä½¿ç”¨</span></span><br><span class="line"><span class="comment"># with open(&#x27;me.bin&#x27;, mode=&quot;wb&quot;) as f:</span></span><br><span class="line"><span class="comment">#     f.write(form_data)</span></span><br><span class="line"><span class="comment"># print(search_request.SerializeToString().decode())</span></span><br><span class="line"></span><br><span class="line">bytes_head = <span class="built_in">bytes</span>([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in">len</span>(form_data)])</span><br><span class="line"><span class="built_in">print</span>(bytes_head+form_data)</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,zh-TW;q=0.8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/grpc-web+proto&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">url = <span class="string">&quot;https://*********/SearchService.SearchService/search&quot;</span></span><br><span class="line">response=requests.post(url,headers=headers,data=bytes_head+form_data)</span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure>

<h3 id="å“åº”å¤„ç†"><a href="#å“åº”å¤„ç†" class="headerlink" title="å“åº”å¤„ç†"></a>å“åº”å¤„ç†</h3><p>æˆ‘ä»¬æ„é€ äº†è¯·æ±‚çš„protoæ–‡ä»¶ï¼Œå¹¶æˆåŠŸç”¨pythonå‘åŒ…è·å¾—äº†æ•°æ®ï¼Œä½†æ˜¯å¾—åˆ°çš„æ•°æ®å’Œf12å¾—åˆ°çš„æ•°æ®æ˜¯ä¸€æ ·çš„ä¹±ç å¦‚ä¸‹å›¾<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/18.webp"
                     
                ><br />å…¶å®è¿™ä¸ªä¹Ÿæ˜¯protobufæ ¼å¼ï¼Œå‘è¿‡å»çš„æ˜¯protobufæ ¼å¼ï¼Œæ”¶åˆ°çš„ä¹Ÿæ˜¯protobufæ ¼å¼ï¼Œåªæ˜¯å®ƒæ˜¯ä»¥äºŒè¿›åˆ¶åºåˆ—åŒ–æ ¼å¼ä¼ è¾“çš„ï¼Œæ‰€ä»¥çœ‹ä¸Šå»åƒä¹±ç .<br />æ¥ä¸‹æ¥ä¼šå¸¦æ¥ä¸¤ç§æ–¹æ³•ï¼šâ‘ ç›´è§‚ä½†æœ‰ç‚¹å¤æ‚ï¼Œâ‘¡ä¾¿æ·ä½†ä¸å¤ªç›´è§‚</p>
<h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p><strong>å†™å¯¹åº”çš„å“åº”çš„protoæ–‡ä»¶ï¼Œå’Œå‘åŒ…ä¸€æ ·ã€‚å½“ç„¶å¯ä»¥å’Œå‘åŒ…å†™åœ¨ä¸€èµ·ã€‚</strong><br />è€è§„çŸ©ï¼Œè¿˜æ˜¯æ‰“æ–­ç‚¹ä»å †æ ˆè¿›è¡Œåˆ†æï¼Œæ ¹æ®å‘åŒ…çš„å †æ ˆä¸»è¦çœ‹appå¼€å¤´çš„jsï¼Œå› ä¸ºchunkå¼€å¤´çš„æ˜¯åŸºæœ¬åº“ï¼Œå¾ˆå°‘åœ¨é‡Œé¢åšæ‰‹è„šï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨è‡ªå†™çš„jsé‡Œé¢åšåŠ å¯†æˆ–å…¶ä»–æ“ä½œã€‚<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/19.webp"
                     
                ><br />ä¸€æ­¥æ­¥è°ƒè¯•åï¼Œ<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/20.webp"
                     
                ><br />å¼‚æ­¥ç„¶åè·å¾—äº†å€¼å».toObject,è¿™ä¸ªtoObjectå°±æ˜¯protoæ–‡ä»¶è½¬jsçš„æ—¶å€™ä¼šäº§ç”Ÿçš„ä¸€ä¸ªapiå‡½æ•°æ¥å£ï¼Œå¯ä»¥ç®€å•ä½¿ç”¨protocå»å°è¯•è½¬åŒ–æˆjsçœ‹çœ‹ã€‚<br />è¿™é‡Œä¸å¥½è·Ÿè¿›ï¼Œç›´æ¥å…¨å±€æœç´¢ä¸€ä¸‹ï¼šproto.SearchService.SearchResponse<br />è¿™é‡Œæ¥å—å“åº”åéœ€è¦æŠŠäºŒè¿›åˆ¶æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œé‚£ä¹ˆå°±ä¼šç”¨åˆ°ä¸‹é¢çš„api<br /><strong><font color="red">deserializeBinaryâ€”â€”deserializeBinaryFromReader</font><strong>ï¼ˆ</strong>é‡ç‚¹æ ¸å¿ƒ</strong>ï¼‰<br />å®Œæ•´çš„å°±æ˜¯ proto.SearchService.SearchResponse.deserializeBinaryFromReader<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/21.webp"
                     
                ><br />ä¸€ä¸‹å­å°±å®šä½åˆ°äº†ï¼Œå’Œè¯·æ±‚çš„ä¸€æ ·ç†è§£ï¼Œåªæ˜¯ä»–ç°åœ¨å˜æˆäº†caseè¯­å¥æ¥è¡¨ç¤ºåºå·ä½ç½®ï¼Œreadåé¢çš„ç±»å‹æ¥è¡¨ç¤ºç±»å‹ã€‚<br />åºå·4æœ‰ä¸ªmessageï¼Œè¿›å»æŸ¥çœ‹<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/22.webp"
                     
                ><br />è¿™ä¸ªè¿”å›çš„æ•°æ®é‡å¤ªå¤§äº†ï¼Œæ ‡å·ä¹Ÿç‰¹åˆ«çš„å¤šï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ³•å¾—åˆ°protoæ–‡ä»¶å‘¢ï¼Ÿ<br />é‚£å°±æ˜¯è‡ªå†™astï¼Œç„¶åç”¨astæ¥å¤„ç†è¿™ç§switchè¯­å¥ã€‚è¿™é‡Œç›´æ¥ä½¿ç”¨æ¸”æ­Œå†™å¥½çš„atsæ’ä»¶ï¼Œæ–‡æœ«é™„ä¸Šé“¾æ¥ï¼Œç½‘ç«™jsæœ‰äº›å°æ›´æ–°ï¼Œä¹‹å‰çš„å¯èƒ½æœ‰äº›å°æŠ¥é”™ï¼Œå°å°çš„ä¿®æ”¹äº†ä¸€ä¸‹<br />è¿™é‡ŒæŠŠæ•´ä¸ªjså¤åˆ¶å‡ºæ¥å‘½åä¸ºtest.jsï¼Œå…ˆå®‰è£…babelè§£æåº“åœ¨å½“å‰ç›®å½•ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @babel/core --save-dev</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œastä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> parser = <span class="built_in">require</span>(<span class="string">&quot;@babel/parser&quot;</span>);</span><br><span class="line"><span class="comment">// ä¸ºparseræä¾›æ¨¡æ¿å¼•æ“</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="built_in">require</span>(<span class="string">&quot;@babel/template&quot;</span>).<span class="property">default</span>;</span><br><span class="line"><span class="comment">// éå†AST</span></span><br><span class="line"><span class="keyword">const</span> traverse = <span class="built_in">require</span>(<span class="string">&quot;@babel/traverse&quot;</span>).<span class="property">default</span>;</span><br><span class="line"><span class="comment">// æ“ä½œèŠ‚ç‚¹ï¼Œæ¯”å¦‚åˆ¤æ–­èŠ‚ç‚¹ç±»å‹ï¼Œç”Ÿæˆæ–°çš„èŠ‚ç‚¹ç­‰</span></span><br><span class="line"><span class="keyword">const</span> t = <span class="built_in">require</span>(<span class="string">&quot;@babel/types&quot;</span>);</span><br><span class="line"><span class="comment">// å°†è¯­æ³•æ ‘è½¬æ¢ä¸ºæºä»£ç </span></span><br><span class="line"><span class="keyword">const</span> generator = <span class="built_in">require</span>(<span class="string">&quot;@babel/generator&quot;</span>);</span><br><span class="line"><span class="comment">// æ“ä½œæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰å…¬å…±å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">wtofile</span>(<span class="params">path, flags, code</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> fd = fs.<span class="title function_">openSync</span>(path,flags);</span><br><span class="line">    fs.<span class="title function_">writeSync</span>(fd, code);</span><br><span class="line">    fs.<span class="title function_">closeSync</span>(fd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dtofile</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    fs.<span class="title function_">unlinkSync</span>(path);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> file_path = <span class="string">&#x27;test.js&#x27;</span>; <span class="comment">//ä½ è¦å¤„ç†çš„æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">var</span> jscode = fs.<span class="title function_">readFileSync</span>(file_path, &#123;</span><br><span class="line">    <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬æ¢ä¸ºASTè¯­æ³•æ ‘</span></span><br><span class="line"><span class="keyword">let</span> ast = parser.<span class="title function_">parse</span>(jscode);</span><br><span class="line"><span class="keyword">let</span> proto_text = <span class="string">`syntax = &quot;proto3&quot;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// protoc --python_out=. app_proto2.proto</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">traverse</span>(ast, &#123;</span><br><span class="line">    <span class="title class_">MemberExpression</span>(path)&#123;</span><br><span class="line">        <span class="keyword">if</span>(path.<span class="property">node</span>.<span class="property">property</span>.<span class="property">type</span> === <span class="string">&#x27;Identifier&#x27;</span> &amp;&amp; path.<span class="property">node</span>.<span class="property">property</span>.<span class="property">name</span> === <span class="string">&#x27;deserializeBinaryFromReader&#x27;</span> &amp;&amp; path.<span class="property">parentPath</span>.<span class="property">type</span> === <span class="string">&#x27;AssignmentExpression&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">let</span> id_name = path.<span class="title function_">toString</span>().<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="title function_">slice</span>(<span class="number">1</span>, -<span class="number">1</span>).<span class="title function_">join</span>(<span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">            path.<span class="property">parentPath</span>.<span class="title function_">traverse</span>(&#123;</span><br><span class="line">                <span class="title class_">VariableDeclaration</span>(path_2)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(path_2.<span class="property">node</span>.<span class="property">declarations</span>.<span class="property">length</span> === <span class="number">1</span>)&#123;</span><br><span class="line">                        path_2.<span class="title function_">replaceWith</span>(t.<span class="title function_">expressionStatement</span>(</span><br><span class="line">                            t.<span class="title function_">assignmentExpression</span>(</span><br><span class="line">                                <span class="string">&quot;=&quot;</span>,</span><br><span class="line">                                path_2.<span class="property">node</span>.<span class="property">declarations</span>[<span class="number">0</span>].<span class="property">id</span>,</span><br><span class="line">                                path_2.<span class="property">node</span>.<span class="property">declarations</span>[<span class="number">0</span>].<span class="property">init</span></span><br><span class="line">                            )</span><br><span class="line">                        ))</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title class_">SwitchStatement</span>(path_2)&#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; path_2.<span class="property">node</span>.<span class="property">cases</span>.<span class="property">length</span> - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                        <span class="keyword">let</span> item = path_2.<span class="property">node</span>.<span class="property">cases</span>[i];</span><br><span class="line">                        <span class="keyword">let</span> item2 = path_2.<span class="property">node</span>.<span class="property">cases</span>[i + <span class="number">1</span>];</span><br><span class="line">                        <span class="keyword">if</span>(item.<span class="property">consequent</span>.<span class="property">length</span> === <span class="number">0</span> &amp;&amp; item2.<span class="property">consequent</span>[<span class="number">1</span>].<span class="property">expression</span>.<span class="property">type</span> === <span class="string">&#x27;SequenceExpression&#x27;</span>)&#123;</span><br><span class="line">                            item.<span class="property">consequent</span> = [</span><br><span class="line">                                item2.<span class="property">consequent</span>[<span class="number">0</span>],</span><br><span class="line">                                t.<span class="title function_">expressionStatement</span>(</span><br><span class="line">                                    item2.<span class="property">consequent</span>[<span class="number">1</span>].<span class="property">expression</span>.<span class="property">expressions</span>[<span class="number">0</span>]</span><br><span class="line">                                ),</span><br><span class="line">                                item2.<span class="property">consequent</span>[<span class="number">2</span>]</span><br><span class="line">                            ];</span><br><span class="line">                            item2.<span class="property">consequent</span>[<span class="number">1</span>] = t.<span class="title function_">expressionStatement</span>(</span><br><span class="line">                                item2.<span class="property">consequent</span>[<span class="number">1</span>].<span class="property">expression</span>.<span class="property">expressions</span>[<span class="number">1</span>]</span><br><span class="line">                            )</span><br><span class="line">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(item.<span class="property">consequent</span>.<span class="property">length</span> === <span class="number">0</span>)&#123;</span><br><span class="line">                            item.<span class="property">consequent</span> = item2.<span class="property">consequent</span></span><br><span class="line">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(item.<span class="property">consequent</span>[<span class="number">1</span>].<span class="property">expression</span>.<span class="property">type</span> === <span class="string">&#x27;SequenceExpression&#x27;</span>)&#123;</span><br><span class="line">                            item.<span class="property">consequent</span>[<span class="number">1</span>] = t.<span class="title function_">expressionStatement</span>(</span><br><span class="line">                                item.<span class="property">consequent</span>[<span class="number">1</span>].<span class="property">expression</span>.<span class="property">expressions</span>[<span class="number">1</span>]</span><br><span class="line">                            )</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">let</span> id_text = <span class="string">&#x27;message &#x27;</span> + id_name + <span class="string">&#x27; &#123;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">            <span class="keyword">let</span> let_id_list = [];</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">// console.log(path.parentPath.node.right.body.body[0].body.body[0].cases.length);</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; path.<span class="property">parentPath</span>.<span class="property">node</span>.<span class="property">right</span>.<span class="property">body</span>.<span class="property">body</span>[<span class="number">0</span>].<span class="property">body</span>.<span class="property">body</span>[<span class="number">0</span>].<span class="property">cases</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">let</span> item = path.<span class="property">parentPath</span>.<span class="property">node</span>.<span class="property">right</span>.<span class="property">body</span>.<span class="property">body</span>[<span class="number">0</span>].<span class="property">body</span>.<span class="property">body</span>[<span class="number">0</span>].<span class="property">cases</span>[i];</span><br><span class="line">                    <span class="keyword">if</span>(item.<span class="property">test</span>)&#123;</span><br><span class="line">                        <span class="keyword">let</span> id_number = item.<span class="property">test</span>.<span class="property">value</span>;</span><br><span class="line">                        <span class="keyword">let</span> key = item.<span class="property">consequent</span>[<span class="number">1</span>].<span class="property">expression</span>.<span class="property">callee</span>.<span class="property">property</span>.<span class="property">name</span>;</span><br><span class="line">                        <span class="keyword">let</span> id_st, id_type;</span><br><span class="line">                        <span class="keyword">if</span>(key.<span class="title function_">startsWith</span>(<span class="string">&quot;set&quot;</span>))&#123;</span><br><span class="line">                            id_st = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(key.<span class="title function_">startsWith</span>(<span class="string">&quot;add&quot;</span>))&#123;</span><br><span class="line">                            id_st = <span class="string">&quot;repeated&quot;</span>;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="comment">// mapç±»å‹ï¼Œå› ä¸ºæ¡ˆä¾‹ä¸­ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥è¿™é‡Œçœç•¥</span></span><br><span class="line">                            <span class="keyword">continue</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        key = key.<span class="title function_">substring</span>(<span class="number">3</span>, key.<span class="property">length</span>);</span><br><span class="line">                        id_type = item.<span class="property">consequent</span>[<span class="number">0</span>];</span><br><span class="line">                        <span class="keyword">if</span>(id_type.<span class="property">expression</span>.<span class="property">right</span>.<span class="property">type</span> === <span class="string">&#x27;NewExpression&#x27;</span>)&#123;</span><br><span class="line">                            id_type = generator.<span class="title function_">default</span>(id_type.<span class="property">expression</span>.<span class="property">right</span>.<span class="property">callee</span>).<span class="property">code</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="title function_">slice</span>(<span class="number">1</span>).<span class="title function_">join</span>(<span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="keyword">switch</span> (id_type.<span class="property">expression</span>.<span class="property">right</span>.<span class="property">callee</span>.<span class="property">property</span>.<span class="property">name</span>) &#123;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readString&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;string&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readDouble&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;double&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readInt32&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;int32&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readInt64&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;int64&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readFloat&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;float&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readBool&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;bool&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readPackedInt32&quot;</span>:</span><br><span class="line">                                    id_st = <span class="string">&quot;repeated&quot;</span>;</span><br><span class="line">                                    id_type = <span class="string">&quot;int32&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readBytes&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;bytes&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readEnum&quot;</span>:</span><br><span class="line">                                    id_type = <span class="string">&quot;readEnum&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;readPackedEnum&quot;</span>:</span><br><span class="line">                                    id_st = <span class="string">&quot;repeated&quot;</span>;</span><br><span class="line">                                    id_type = <span class="string">&quot;readEnum&quot;</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span>(id_type === <span class="string">&#x27;readEnum&#x27;</span>)&#123;</span><br><span class="line">                            id_type = id_name + <span class="string">&#x27;_&#x27;</span> + key + <span class="string">&#x27;Enum&#x27;</span>;</span><br><span class="line">                            <span class="keyword">if</span>(let_id_list.<span class="title function_">indexOf</span>(id_number) === -<span class="number">1</span>)&#123;</span><br><span class="line">                                id_text += <span class="string">&#x27;\tenum &#x27;</span> + id_type + <span class="string">&#x27; &#123;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">                                <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">                                    id_text += <span class="string">&#x27;\t\t&#x27;</span> + id_type + <span class="string">&#x27;TYPE_&#x27;</span> + j + <span class="string">&#x27; = &#x27;</span> + j + <span class="string">&#x27;;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                id_text += <span class="string">&#x27;\t&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">                                id_text += <span class="string">&#x27;\t&#x27;</span> + id_st + <span class="string">&#x27; &#x27;</span> + id_type + <span class="string">&#x27; &#x27;</span> + key + <span class="string">&#x27; = &#x27;</span> + id_number + <span class="string">&#x27;;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">                                let_id_list.<span class="title function_">push</span>(id_number)</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="keyword">if</span>(let_id_list.<span class="title function_">indexOf</span>(id_number) === -<span class="number">1</span>)&#123;</span><br><span class="line">                                id_text += <span class="string">&#x27;\t&#x27;</span> + id_st + <span class="string">&#x27; &#x27;</span> + id_type + <span class="string">&#x27; &#x27;</span> + key + <span class="string">&#x27; = &#x27;</span> + id_number + <span class="string">&#x27;;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">                                let_id_list.<span class="title function_">push</span>(id_number)</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            id_text += <span class="string">&#x27;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">            proto_text += id_text</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">wtofile</span>(<span class="string">&#x27;app_proto3.proto&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, proto_text);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªastä»£ç å•çº¯åªæ˜¯é’ˆå¯¹è¿™ä¸ªç«™ç‚¹ï¼Œå…¶ä»–ç«™ç‚¹ä¹Ÿæ˜¯ç±»ä¼¼åˆ†æã€‚<br />è¿è¡Œåç”Ÿæˆäº†app_proto3.protoæ–‡ä»¶ï¼Œæ‰“å¼€çœ‹ä¸€é¢æœ‰ä¸€äº›æŠ¥é”™ï¼Œå¦‚ä¸‹å›¾ï¼Œæ¸”æ­Œæ–‡ç« ä¹Ÿè®²æ¸…æ¥šäº†åŸå› ï¼Œå› ä¸ºå¯¹è±¡è°ƒç”¨deserializeBinaryFromReaderæ–¹æ³•çš„æ—¶å€™ï¼Œastä»£ç å¤„ç†å¯¹è±¡æ— æ³•ç¡®å®šï¼Œæ‰€ä»¥å°±æ²¡åŠ è½½åˆ°ã€‚<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/23.webp"
                     
                ><br />æˆ‘ä»¬åœ¨è°ƒè¯•é‡Œé¢ï¼Œæœç´¢å…³é”®è¯ExportResponse.deserializeBinaryFromReader<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/24.webp"
                     
                ><br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/25.webp"
                     
                ><br />è·Ÿè¿›å»å°±èƒ½æ‰¾åˆ°så¯¹è±¡æ˜¯ä»€ä¹ˆï¼Œè¡¥ä¸Šå°±è¡Œï¼Œå…¶ä»–çš„æŠ¥é”™ä¹Ÿæ˜¯è¿™æ ·çš„æ“ä½œ<br />å¾—åˆ°äº†protoæ–‡ä»¶åè¿›è¡Œç¼–è¯‘æˆpython </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc --python_out=. ./app_proto3.<span class="property">proto</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå‘ä¸ªè¯·æ±‚è¯•ä¸€è¯•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> app_proto3_pb2 <span class="keyword">as</span> pb</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">search_request = pb.SearchService_SearchRequest()  <span class="comment"># å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment"># æŒ‰ä¸Šé¢è§£ææ•°æ®ï¼ŒæŒ‰ç…§å¯¹åº”çš„å±æ€§è®¾ç½®å€¼</span></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²ï¼Œæ•°å­—å‹çš„éƒ½æ˜¯ç›´æ¥èµ‹å€¼</span></span><br><span class="line">search_request.Commonrequest.SearchType = <span class="string">&#x27;paper&#x27;</span></span><br><span class="line">search_request.Commonrequest.SearchWord = <span class="string">&#x27;python&#x27;</span></span><br><span class="line">search_request.Commonrequest.CurrentPage = <span class="number">2</span></span><br><span class="line">search_request.Commonrequest.PageSize = <span class="number">20</span></span><br><span class="line"><span class="comment"># repeatedä¿®é¥°çš„messsageç±»å‹å’Œenumç±»å‹ï¼Œåˆ™éœ€è¦ç¨å¾®å¤šå‡ ä¸ªæ­¥éª¤</span></span><br><span class="line">search_request.Commonrequest.SearchFilterList.append(<span class="number">0</span>)</span><br><span class="line">search_request.InterfaceType = <span class="number">1</span></span><br><span class="line">form_data = search_request.SerializeToString()</span><br><span class="line"><span class="built_in">print</span>(form_data)</span><br><span class="line"><span class="comment"># ä¿å­˜æ•°æ®ç®binæ–‡ä»¶ä¾›åç»­å¯¹æ¯”ä½¿ç”¨</span></span><br><span class="line"><span class="comment"># with open(&#x27;me.bin&#x27;, mode=&quot;wb&quot;) as f:</span></span><br><span class="line"><span class="comment">#     f.write(form_data)</span></span><br><span class="line"><span class="comment"># print(search_request.SerializeToString().decode())</span></span><br><span class="line"></span><br><span class="line">bytes_head = <span class="built_in">bytes</span>([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in">len</span>(form_data)])</span><br><span class="line"><span class="built_in">print</span>(bytes_head + form_data)</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/grpc-web+proto&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">url = <span class="string">&quot;https://*********.com.cn/SearchService.SearchService/search&quot;</span></span><br><span class="line">response = requests.post(url, headers=headers, data=bytes_head + form_data)</span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line"></span><br><span class="line">search_response = pb.SearchService_SearchResponse()</span><br><span class="line">search_response.ParseFromString(response.content[<span class="number">5</span>:])</span><br><span class="line"><span class="built_in">print</span>(search_response)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¾ˆç›´è§‚ï¼Œå–å€¼ä¹Ÿæ–¹ä¾¿ã€‚<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/26.webp"
                     
                ><br />ä¸Šé¢ä¹‹æ‰€ä»¥ä»å“åº”çš„ç¬¬å…­ä½å­—èŠ‚å¼€å¯å–ï¼Œæ˜¯è·Ÿä¸Šé¢å‘åŒ…ä¸€æ ·çš„ï¼Œå‰äº”ä¸ªå­—èŠ‚è¡¨ç¤ºè¯·æ±‚å¤´çš„é•¿åº¦<br />ä¸‹é¢æ˜¯protoçš„æ ¸å¿ƒï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–<br /><strong><font color="red">serializeBinaryâ€”â€”serializeBinaryFromReader</font><strong>ï¼ˆ</strong>é‡ç‚¹æ ¸å¿ƒ</strong>ï¼‰<br /><strong><font color="red">deserializeBinaryâ€”â€”deserializeBinaryFromReader</font><strong>ï¼ˆ</strong>é‡ç‚¹æ ¸å¿ƒ</strong>ï¼‰</p>
<h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>ä½¿ç”¨pythonåº”å¯¹protobufçš„ç¬¬ä¸‰æ–¹åº“ï¼šblackboxprotobuf<br />å®‰è£…å‘½ä»¤ï¼špip install blackboxprotobuf<br />è°ƒç”¨æ ¸å¿ƒå‡½æ•° ï¼šblackboxprotobuf.decode_message(<strong>Byteç±»å‹æ•°æ®</strong>)ï¼Œè¿›è¡Œè§£protobufæ ¼å¼æ•°æ®<br /><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230201/27.webp"
                     
                ><br />ä¸Šé¢æ˜¯æ•°æ®å¯¹åº”ç»“æ„ä½ç½®ï¼Œä¸‹é¢æ˜¯ç±»å‹å¯¹åº”ç»“æ„ä½ç½®<br />è™½ç„¶æ‹¿åˆ°äº†æ•°æ®ï¼Œåªæ˜¯ä½ç½®åºå·åŠ å†…å®¹ï¼Œæˆ‘ä»¬å…¶å®è¦é çŒœæ‰èƒ½çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œè¿™ç§å°±ä¸éœ€è¦å»å†™protoæ–‡ä»¶<br />ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ï¼Œå–œæ¬¢å“ªç§ç”¨å“ªç§</p>
<h3 id="ç›¸å…³èµ„æ–™å‚è€ƒ"><a href="#ç›¸å…³èµ„æ–™å‚è€ƒ" class="headerlink" title="ç›¸å…³èµ„æ–™å‚è€ƒ"></a>ç›¸å…³èµ„æ–™å‚è€ƒ</h3><p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/dideng7039/article/details/101869819" >https://blog.csdn.net/dideng7039/article/details/101869819<i class="fas fa-external-link-alt"></i></a><br /><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35491275/article/details/111721639" >https://blog.csdn.net/qq_35491275&#x2F;article&#x2F;details&#x2F;111721639<i class="fas fa-external-link-alt"></i></a><br /><a class="link"   target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/DzCz66_Szc7vfG6bpl956w" >https://mp.weixin.qq.com/s/DzCz66_Szc7vfG6bpl956w<i class="fas fa-external-link-alt"></i></a><br /><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_56881388/article/details/128612717" >https://blog.csdn.net/qq_56881388&#x2F;article&#x2F;details&#x2F;128612717<i class="fas fa-external-link-alt"></i></a></p>

                </div>

                
                        <div class="article-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="post-title border-box text-ellipsis">
                ProtoBufåˆ†æä»¥åŠæŸæ–¹æ•°æ®é€†å‘
            </div>

            <div class="post-link border-box text-ellipsis">
                posts/13480/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="post-author bottom-item">
                <div class="type">
                    ä½œè€…
                </div>
                <div class="content">zsk</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    å‘å¸ƒäº
                </div>
                <div class="content">2023-02-01 01:26</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    è®¸å¯
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">
                        <i class="fa-brands fa-creative-commons"></i>
                        <i class="fa-brands fa-creative-commons-by"></i>
                        <i class="fa-brands fa-creative-commons-nc"></i>
                        <i class="fa-brands fa-creative-commons-sa"></i>
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="å¤åˆ¶ç‰ˆæƒä¿¡æ¯" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/js/">js</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/protobuf/">protobuf</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                            <div class="post-share-container border-box">
    <ul class="share-list-wrap border-box">
        <li class="qq share-item border-box flex-center tooltip"
            data-tooltip-content="åˆ†äº«åˆ° QQ"
        >
            <i class="fa-brands fa-qq"></i>
        </li>
        <li class="wechat share-item border-box flex-center tooltip tooltip-img"
            data-tooltip-content="åˆ†äº«åˆ°å¾®ä¿¡"
            data-tooltip-img-tip="å¾®ä¿¡æ‰«ä¸€æ‰«"
            data-tooltip-img-style="background-color: #fff; top: -10px; padding: 0.6rem 0.6rem 0.1rem 0.6rem;"
        >
            <i class="fa-brands fa-weixin"></i>
        </li>
        <li class="weibo share-item border-box flex-center tooltip"
            data-tooltip-content="åˆ†äº«åˆ°å¾®åš"
        >
            <i class="fa-brands fa-weibo"></i>
        </li>
    </ul>
</div>

                        
                    </div>
                </div>

                

                
                    <div class="article-nav">
                        
                            <div class="article-prev">
                                <a class="prev"
                                   rel="prev"
                                   href="/posts/14763/"
                                   title="ProtoBufé€†å‘ä¹‹æŸå…¬äº¤app"
                                >
                                    <span class="left arrow-icon flex-center">
                                      <i class="fas fa-chevron-left"></i>
                                    </span>
                                            <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">ProtoBufé€†å‘ä¹‹æŸå…¬äº¤app</span>
                                        <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="article-next">
                                <a class="next"
                                   rel="next"
                                   href="/posts/17732/"
                                   title="AESçŸ¥é“æŸä¸€è½®æ¬¡å¯†é’¥åæ¨ä¸»å¯†é’¥"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">AESçŸ¥é“æŸä¸€è½®æ¬¡å¯†é’¥åæ¨ä¸»å¯†é’¥</span>
                                        <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                                    </span>
                                            <span class="right arrow-icon flex-center">
                                      <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;è¯„è®º
        </div>
        
            

    <div class="valine-container">
        <script data-pjax src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
          function loadValine() {

            const config = {
              el: '#vcomments',
              appId: 'WxNQs5QEQtykF82Sb7nAjXRO-gzGzoHsz',
              appKey: '4rZ6NwH5zAu6VEspHwVrgqOq',
              meta: ['nick', 'mail', 'link'],
              avatar: 'wavatar',
              enableQQ: true,
              placeholder: 'ğŸ˜œ å°½æƒ…åæ§½å§~',
              lang: 'zh-CN'.toLowerCase()
            }

            if ('') {
              config.serverURLs = ''
            }

            new Valine(config)

            function getAuthor(language) {
              switch (language) {
                case 'en':
                  return 'Author'
                case 'zh-CN':
                  return 'åšä¸»'
                case 'zh-TW':
                  return 'ç«™é•·'
                default:
                  return 'Master'
              }
            }

            // Add "Author" identify
            const getValineDomTimer = setInterval(() => {
              const vcards = document.querySelectorAll('#vcomments .vcards .vcard')
              if (vcards.length > 0) {
                let author = 'zsk'

                if (author) {
                  for (let vcard of vcards) {
                    const vnick_dom = vcard.querySelector('.vhead .vnick')
                    const vnick = vnick_dom.innerHTML
                    if (vnick === author) {
                      vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                    }
                  }
                }
                clearInterval(getValineDomTimer)
              } else {
                clearInterval(getValineDomTimer)
              }
            }, 2000)
          }

          if ('true' === 'true') {
            const loadValineTimeout = setTimeout(() => {
              loadValine()
              clearTimeout(loadValineTimeout)
            }, 1000)
          } else {
            window.addEventListener('DOMContentLoaded', loadValine)
          }
        </script>
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFprotobuf"><span class="nav-number">1.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯protobuf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%82%A3%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8protobuf%EF%BC%9F"><span class="nav-number">2.</span> <span class="nav-text">é‚£å¦‚ä½•ä½¿ç”¨protobufï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E8%AF%95JS%E5%8F%8D%E5%86%99proto"><span class="nav-number">3.</span> <span class="nav-text">è°ƒè¯•JSåå†™proto</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E8%AF%B7%E6%B1%82"><span class="nav-number">4.</span> <span class="nav-text">å®ç°è¯·æ±‚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86"><span class="nav-number">5.</span> <span class="nav-text">å“åº”å¤„ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">5.1.</span> <span class="nav-text">æ–¹æ³•ä¸€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-number">5.2.</span> <span class="nav-text">æ–¹æ³•äºŒ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99%E5%8F%82%E8%80%83"><span class="nav-number">6.</span> <span class="nav-text">ç›¸å…³èµ„æ–™å‚è€ƒ</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="border-box website-info-box default">
        
            <div class="copyright-info info-item default">
                &copy;&nbsp;<span>2021</span>&nbsp;-&nbsp;2024
                
                    &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">zsk</a>
                
            </div>

            <div class="theme-info info-item default">
                ç”±&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;é©±åŠ¨&nbsp;&&nbsp;ä¸»é¢˜&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
            </div>

            

            
                <div class="deploy-info info-item default">
                    
                        æœ¬ç«™ç”± <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/deploy-provider/github.png"></span> æä¾›éƒ¨ç½²æœåŠ¡
                        
                </div>
            
        

        <div class="count-item info-item default">
            
                <span class="count-box border-box word">
                    <span class="item-type border-box">æ€»å­—æ•°</span>
                    <span class="item-value border-box word">84.7k</span>
                </span>
            

            
                <span class="count-box border-box uv">
                    <span class="item-type border-box">è®¿å®¢æ•°</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-box border-box pv">
                    <span class="item-type border-box">è®¿é—®é‡</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    </div>
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="tools-list border-box">
        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFprotobuf"><span class="nav-number">1.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯protobuf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%82%A3%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8protobuf%EF%BC%9F"><span class="nav-number">2.</span> <span class="nav-text">é‚£å¦‚ä½•ä½¿ç”¨protobufï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E8%AF%95JS%E5%8F%8D%E5%86%99proto"><span class="nav-number">3.</span> <span class="nav-text">è°ƒè¯•JSåå†™proto</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E8%AF%B7%E6%B1%82"><span class="nav-number">4.</span> <span class="nav-text">å®ç°è¯·æ±‚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86"><span class="nav-number">5.</span> <span class="nav-text">å“åº”å¤„ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">5.1.</span> <span class="nav-text">æ–¹æ³•ä¸€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-number">5.2.</span> <span class="nav-text">æ–¹æ³•äºŒ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99%E5%8F%82%E8%80%83"><span class="nav-number">6.</span> <span class="nav-text">ç›¸å…³èµ„æ–™å‚è€ƒ</span></a></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>



<!-- common -->
<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/libs/anime.min.js"></script>

<!-- local-search -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/local-search.js"></script>


<!-- code-block -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/code-block.js"></script>


<!-- lazyload -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/lazyload.js"></script>


<div class="pjax">
    
        <!-- post-helper -->
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/post-helper.js"></script>

        <!-- toc -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/toc.js"></script>
        

        <!-- copyright-info -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/copyright-info.js"></script>
        

        <!-- share -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/share.js"></script>
        
    

    <!-- category-page -->
    

    <!-- links-page -->
    
</div>

<!-- pjax -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart()
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd()
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'))
            KEEP.initExecute()
        });
    });
</script>




    
        
    
        
            
<script class="custom-inject-js" src="/js/custom-1.js" data-pjax></script>

        
    

</body>
</html>
