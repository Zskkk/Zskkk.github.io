<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="zsk">
    <meta name="baidu-site-verification" content="codeva-FDuSf8Qgto" />
    
    <title>
        
            Arm汇编 |
        
        zskのblog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/logo.svg">
    
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/font/css/brands.min.css">
    
        
            
        
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"www.zskkk.cn","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true,"layout":"right"},"style":{"primary_color":"#0066cc","logo":"/images/logo.svg","favicon":"/images/logo.svg","avatar":"/images/head.svg","first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"valine","valine":{"appid":"WxNQs5QEQtykF82Sb7nAjXRO-gzGzoHsz","appkey":"4rZ6NwH5zAu6VEspHwVrgqOq","server_urls":null,"placeholder":"😜 尽情吐槽吧~"},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.21"},"waline":{"server_url":null,"reaction":false,"version":2},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":true,"reward":{"enable":false,"img_link":null,"text":null}},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"version":"3.8.1"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container border-box">

    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               zskのblog
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">

                

                    <div class="fade-in-down-animation">
    <div class="post-page-container border-box">

        <div class="article-content-container border-box">

            

            <div class="article-content-bottom border-box">
                
                    <div class="article-title">
                        Arm汇编
                    </div>
                

                
                    <div class="article-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/head.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author">
                                <span class="name">zsk</span>
                                
                                    <span class="author-label">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="article-meta-info-container border-box post">
    <div class="article-meta-info border-box">
        


        
            <span class="meta-info-item article-create-date">
                <i class="icon fa-solid fa-calendar-check"></i>&nbsp;
                <span class="pc">2023-09-01 00:00:00</span>
                <span class="mobile">2023-09-01 00:00</span>
            </span>

            <span class="meta-info-item article-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="pc" data-updated="Fri Sep 01 2023 00:00:00 GMT+0800">2023-09-01 00:00:00</span>
            </span>
        

        

        
            <span class="article-tag meta-info-item border-box">
                <i class="icon fas fa-tags"></i>&nbsp;
                <ul>
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/ARM/">ARM</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item article-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>8.5k 字</span>
            </span>
        
        
            <span class="meta-info-item article-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>34 分钟</span>
            </span>
        
        
            <span class="meta-info-item article-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="article-content keep-markdown-body">
                    

                    <p><strong>以下ARM笔记我基于 <a class="link"   target="_blank" rel="noopener" href="https://space.bilibili.com/37877654" >_周壑<i class="fas fa-external-link-alt"></i></a> 大佬在b站的视频教程整理来的，推荐配合视频使用</strong></p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>arm文档下载链接：<a class="link"   target="_blank" rel="noopener" href="https://documentation-service.arm.com/static/644a406baa78c007af74e6fd?token=" >https://documentation-service.arm.com/static/644a406baa78c007af74e6fd?token=<i class="fas fa-external-link-alt"></i></a></br>其中指令集在目录 F5.1 Alphabetical list of T32 and A32 base instruction set instructions。</br>在android studio中创建设备，选择api17的，armeabi-v7a架构。</br>创建后的设备默认路径在 C:\Users\zsk.android\avd，snapshots保存的是快照</br>快捷方式启动设备：</br>    创建bat文件，输入D:\Android\Sdk\emulator\emulator.exe -avd Pixel_XL_API_17_2，运行启动设备</br>将ida的android-server push到设备上，android-server文件在ida目录下的dbgsrv</br>push后修改文件权限为777，运行，端口转发：adb forward tcp:23946 tcp:23946</br>运行后就可以在ida选择设备调试，Debugger -&gt; Attach -&gt; Remote ARMLinux&#x2F;Android debugger</br>hostname填localhost，没有进行端口转发则需要填手机ip，能看到进程列表则成功</br></p>
<h2 id="c文件编译成arm运行"><a href="#c文件编译成arm运行" class="headerlink" title="c文件编译成arm运行"></a>c文件编译成arm运行</h2><p>在window下把c文件编译为arm的前置准备</br>hello.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;hello\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在同级目录下新建Application.mk，Android.mk文件</br><a class="link"   target="_blank" rel="noopener" href="https://developer.android.google.cn/ndk/guides/android_mk?hl=zh-cn" >https://developer.android.google.cn/ndk/guides/android_mk?hl&#x3D;zh-cn<i class="fas fa-external-link-alt"></i></a></br><br>Application.mk</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">APP_ABI := armeabi-v7a</span><br><span class="line">APP_BUILD_SCRIPT := Android.mk</span><br><span class="line">APP_PLATFORM := android-16</span><br></pre></td></tr></table></figure>
<p>Android.mk</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LOCAL_PATH := <span class="variable">$(<span class="built_in">call</span> my-<span class="built_in">dir</span>)</span></span><br><span class="line"><span class="comment">#include $(CLEAR_VARS)</span></span><br><span class="line">LOCAL_ARM_MODE := arm</span><br><span class="line">LOCAL_MODULE := <span class="string">&quot;hello&quot;</span></span><br><span class="line">LOCAL_SRC_FILES := hello.c</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(BUILD_EXECUTABLE)</span></span><br></pre></td></tr></table></figure>
<p>编译，可以弄成bat方便执行</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndk-build NDK_PROJECT_PATH=. NDK_APPLICATION_MK=Application.mk</span><br></pre></td></tr></table></figure>
<p>需要在Android studio中下载ndk工具，下载好后会在sdk下有ndk文件，进入选择随便一个版本路径配置环境变量</br>运行显示过程</br>[armeabi-v7a] Compile thumb  : hello &lt;&#x3D; hello.c</br>[armeabi-v7a] Executable     : hello</br>[armeabi-v7a] Install        : hello &#x3D;&gt; libs&#x2F;armeabi-v7a&#x2F;hello</br>结束后会在目录生成obj和libs文件，在libs下是hello可执行文件，obj下是debugger版的可执行文件，调试的话就用obj下的。</br>将文件push到手机，修改777权限，执行运行</br></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">root@android:/data/local/tmp # chmod 777 hello</span></span><br><span class="line"><span class="section">root@android:/data/local/tmp # ./hello</span></span><br><span class="line">hello</span><br></pre></td></tr></table></figure>
<p>这样一下子就运行玩完了，没法调试，修改代码让它一直运行</br></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;hello\n&quot;</span>);</span><br><span class="line">        getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重新编译并推送执行</br></p>
<h2 id="ida调试"><a href="#ida调试" class="headerlink" title="ida调试"></a>ida调试</h2><p>回到ida，调试运行中的hello程序</br><br>避免每次都要执行多行命令，可以整合成一个bat</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb push D:\Android\arm_test\obj\local\armeabi-v7a\hello /data/local/tmp/</span><br><span class="line">adb shell &quot;chmod 777 /data/local/tmp/hello&quot;</span><br><span class="line">adb shell &quot;/data/local/tmp/hello&quot;</span><br></pre></td></tr></table></figure>

<h2 id="寄存器和指令基本格式"><a href="#寄存器和指令基本格式" class="headerlink" title="寄存器和指令基本格式"></a>寄存器和指令基本格式</h2><p>没有隐式内存操作指令，</br><br>一条ARM汇编指令可以包含0到3个操作数。操作数是指执行指令时所涉及的数据或寄存器。内存操作数和里脊操作数不能同时存在，意味着在一条指令中，不能同时存在既是内存操作数又是寄存器操作数。你要么使用内存地址作为操作数，要么使用寄存器。内存操作数至多出现一次，寄存器操作数总在最前面</br></p>
<ul>
<li><p>特殊情况：</br></p>
<ul>
<li>读PC寄存器，arm读PC加8，thumb读PC加4</br></li>
<li>C标志位使用</br></li>
</ul>
</li>
<li><p>寄存器： </br></p>
<ul>
<li>寄存器是计算机中一种高速的、临时的、可用于存储和操作数据的存储单元。在ARM架构中，通常使用 R0、R1、R2 等寄存器来表示通用寄存器。这些寄存器可以用来存储临时数据、地址或执行算术和逻辑运算。</br></li>
</ul>
</li>
<li><p>立即数： </br></p>
<ul>
<li>立即数是在指令中直接提供的常数值，而不是从内存中加载。在汇编语言中，可以使用 # 符号表示立即数。例如，在 MOV R0, #10 中，#10 就是一个立即数，表示将值 10 直接存储到寄存器 R0 中。</br></li>
</ul>
</li>
<li><p>操作数： </br></p>
<ul>
<li>操作数是参与运算的数据或者指令中的一个参数。在指令中，你可能会看到源操作数和目标操作数。在 MOV R0, #10 中，#10 是源操作数，表示移动的数据；而 R0 是目标操作数，表示数据要移动到的位置。</br></li>
</ul>
</li>
<li><p>MOV：</br></p>
<ul>
<li>用于将一个数值（立即数或寄存器中的值）移动到目标寄存器。</br>    MOV R0, #10       ; 将立即数 10 移动到寄存器 </br>    R0 MOV R1, R2        ; 将寄存器 R2 中的值移动到寄存器 R1</br></li>
</ul>
</li>
<li><p>基本运算：</br></p>
<ul>
<li>ADD：加法指令。</br></li>
<li>ADR：将地址加载到寄存器的伪指令。</br></li>
<li>SUB：减法指令。</br></li>
<li>RSB：反向减法指令。</br></li>
<li>AND：按位与运算指令。</br></li>
<li>BIC：按位与非运算指令。</br></li>
<li>ORR：按位或运算指令。</br></li>
<li>EOR：按位异或运算指令。</br></li>
<li>LSL：逻辑左移指令。</br></li>
<li>LSR：逻辑右移指令。</br></li>
<li>ASR：算术右移指令。</br></li>
</ul>
</li>
<li><p>访存：</br></p>
<ul>
<li>LDR：从内存中加载数据到寄存器。</br></li>
<li>STR：将寄存器中的数据存储到内存。</br></li>
</ul>
</li>
<li><p>块访存：</br></p>
<ul>
<li>LDMFD：从内存中加载多个寄存器，然后递减栈指针。</br></li>
<li>LDMIA：从内存中加载多个寄存器，然后递增基址寄存器。</br></li>
<li>STMFD：将多个寄存器的值存储到内存，然后递减栈指针。</br></li>
<li>STMIA：将多个寄存器的值存储到内存，然后递增基址寄存器。</br></li>
</ul>
</li>
<li><p>分支：</br></p>
<ul>
<li>B：无条件分支。</br></li>
<li>BL：带链接的无条件分支，用于函数调用。</br></li>
<li>BX：无条件分支并切换指令集（ARM&#x2F;Thumb）。</br></li>
<li>BLX：带链接的无条件分支并切换指令集。</br></li>
</ul>
</li>
</ul>
<p>在ida中按ctrl+alt+k可以修改指令</p>
<h2 id="条件和标志位响应"><a href="#条件和标志位响应" class="headerlink" title="条件和标志位响应"></a>条件和标志位响应</h2><h3 id="条件指令"><a href="#条件指令" class="headerlink" title="条件指令"></a>条件指令</h3><p><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/1.webp"
                     
                ></br>条件指令是加在运算符后面的，如何看懂？</br>例如机器码为：</br>03 00 10 E3	TST</br>小端序排序的，前高4位是条件，看最高位也就是E，E的对应的bit为1110，也就是None，无条件，可以说E是出现最多的</br>06 00 00 0A	BEQ</br>最高位0，0就是EQ，</br>03 00 52 21	CMPCS</br>最高位为2，2就是0010，CS</br>指令后缀带S的，表示执行完标志位会改变</br>01 00 80 E0	ADD	R0, R0, R1</br>01 00 90 E0	ADDS	R0, R0, R1</br>01 00 40 E0	SUB		R0, R0, R1</br>01 00 50 E0	SUBS	R0, R0, R1</br>S是由第20个bit控制，也就是上面的8，9</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/2.webp"
                     
                ></br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/3.webp"
                     
                ></br></p>
<p>S位为0就是不带S，为就是S</br>大部分算术指令都可以加S，CMP不行，CMP的20位固定为1</br></p>
<ul>
<li>运算指令可以分为以下三种：</br><ul>
<li>第一种既要结果又要标志寄存器，subs，adds</br></li>
<li>第二种只要结果，sub，add</br></li>
<li>第三种只要标志寄存器，cmp，cmn</br></li>
</ul>
</li>
</ul>
<h2 id="MOV指令"><a href="#MOV指令" class="headerlink" title="MOV指令"></a>MOV指令</h2><h3 id="立即数"><a href="#立即数" class="headerlink" title="立即数"></a>立即数</h3><p><strong>Move（immediate）将立即数值写入目标寄存器。</strong><br>mov是不访问内存，没有写内存的功能。那就只有寄存器操作数或者立即操作数</br>mov是把第二个操作数（可能是寄存器也可能是立即数）写到第一个操作数，那第一个操作数只能是寄存器操作数</br>arm指令是定长32位的，也就是立即数长度肯定不会超过32位</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/4.webp"
                     
                ><br>这里立即数的位数是imm4+imm12，也就是16位</br>例如：</br>34 82 01 E3                   MOVW            R8, #0x1234</br>如果是超过16位，则写不进。</br>第15-12位4位二进制的长度刚好16对应着r0-r15</br>还有一种A1格式，立即数是可以超过16-32位的</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/5.webp"
                     
                ></br><br>02 81 A0 E3                   MOV             R8, #0x80000000</br>虽然这里长度比16位大，但是它的有效位只有最高位的8，这里是把2向右移动1*2位， 0010 -&gt;右移2位-&gt; 1000 -&gt; 8(十进制)</br>01 81 A0 E3                   MOV             R8, #0x40000000</br>把1向右移动1*2位，0001 -&gt;右移2位-&gt; 0100 -&gt; 4(十进制)</br>02 82 A0 E3                   MOV             R8, #0x20000000</br>把2向右移动4位，0010 -&gt;右移4位-&gt; 0010 -&gt; 2(十进制)</br>立即数的有效位数比较密集，可以集中在8位范围内还是偶数</br>如果真要写入32位有效数如何做？</br>先写一条指令 mov r0, 0x5678 </br>再写 movt r0, 0x1234 写到高16位，ida会两句合成一句伪指令</br>78 06 05 E3 34 02 41 E3       MOV             R0, #0x12345678</br></p>
<h3 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h3><p><strong>Move（register）将值从寄存器复制到目标寄存器。</strong></br></p>
<p>上面说的是立即数到寄存器，这个是寄存器到寄存器</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/6.webp"
                     
                ></br></p>
<p>除了： 01 00 A0 E1                   MOV             R0, R1</br>还能： 01 02 A0 E1                   MOV             R0, R1,LSL#4 （R0是一个操作数，R1,LSL#4整体是一个操作数）R1向左移动4位写到r0里</br>看第7-11位，5位的长度也就是2的32次方来表示偏移</br>第5-6位，stype2位的长度有4种情况，逻辑左移，逻辑右移，算术右移 ，循环移位（算术左移的逻辑和逻辑左移是一样的，循环移位不区分左右移，比如循环左移1位和循环右移32位是一样的）</br>此指令由别名 ASRS (immediate), ASR (immediate), LSLS (immediate), LSL (immediate), LSRS (immediate), LSR (immediate), RORS (immediate), ROR (immediate), RRXS, and RRX使用.</br> 指令lsl r0, r1,4 的效果跟 R0, R1,LSL#4 是一样的</br>所以 ASRS, ASR, LSLS, LSL, LSRS, LSR, RORS, ROR, RRXS, RRX 实际上都可以认为是mov指令的一个宏，另一种写法，在ida中都会翻译成mov指令</br>常用的也就是逻辑左移，逻辑右移，算术右移，都是一些数组，结构体偏移寻址的</br></p>
<h3 id="寄存器移位寄存器"><a href="#寄存器移位寄存器" class="headerlink" title="寄存器移位寄存器"></a>寄存器移位寄存器</h3><p>Move（寄存器移位寄存器）将寄存器移位后的寄存器值复制到目标寄存器。</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/7.webp"
                     
                ></br></p>
<p>例如：11 02 A0 E1                   MOV             R0, R1,LSL R2</br></p>
<h2 id="基本整型运算"><a href="#基本整型运算" class="headerlink" title="基本整型运算"></a>基本整型运算</h2><p>指令基本都是3个操作数，第一个是写入，第二三个是做运算。（寄存器，寄存器，立即数）  或者是 （寄存器，寄存器，寄存器）。</br><br><strong>下面指令都有多种格式，立即数，寄存器，移位寄存器等等。只列举立即数的情况</strong></br></p>
<h3 id="ADD-ADDS-immediate"><a href="#ADD-ADDS-immediate" class="headerlink" title="ADD, ADDS (immediate)"></a>ADD, ADDS (immediate)</h3><p>加法指令。</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/8.webp"
                     
                ></br></p>
<p>立即数长度12，分为有效数字低8位，高4位做位移循环。这种叫A32ExpandImm，把imm12扩展成32位</br></p>
<h3 id="ADD-ADDS-register"><a href="#ADD-ADDS-register" class="headerlink" title="ADD, ADDS (register)"></a>ADD, ADDS (register)</h3><p><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/9.webp"
                     
                ></br></p>
<h3 id="ADR"><a href="#ADR" class="headerlink" title="ADR"></a>ADR</h3><p>将地址加载到寄存器的伪指令。</br>从PC相对地址将立即值添加到PC值以形成PC相对地址，并写入结果发送到目标寄存器。</br>该指令由伪指令ADD（立即，到PC）和SUB（立即，从PC）使用。这个伪指令从来都不是首选的反汇编。</br>例如指令 add, r0, pc, 4（把pc+4赋给r0）会在ida变成</br>04 00 8F E2                   ADR             R0, loc_16FD4</br>从pc+4会涉及到读pc，读pc  要+8，加上4就是12</br>00016FD0 04 00 8F E2                   ADR             R0, loc_16FDC</br>00016FDC                               loc_16FDC</br></p>
<h3 id="SUB"><a href="#SUB" class="headerlink" title="SUB"></a>SUB</h3><p>减法指令。</br>从PC中减去从对齐（PC，4）值减去立即值以形成一个PC相关地址，并将结果写入目标寄存器。</br>02 00 41 E0                   SUB             R0, R1, R2（r0&#x3D;r1-r2）</br></p>
<h3 id="RSB"><a href="#RSB" class="headerlink" title="RSB"></a>RSB</h3><p>反向减法指令。</br>反向减法指令，反向减法（立即数）从立即数中减去寄存器值，并将结果写入目的地寄存器。</br>08 00 61 E2                   RSB             R0, R1, #8（8-r1的值写入r0）</br>08 00 61 E2                   RSB             R0, R1, R2（r2-r1的值写入r0）</br></p>
<h3 id="AND"><a href="#AND" class="headerlink" title="AND"></a>AND</h3><p>按位与运算指令。</br>按位与(立即数)对寄存器值和立即数执行位与，并将结果写入到目标寄存器。</br>02 00 01 E0                   AND             R0, R1, R2（r0 &#x3D; r1 &amp; r2）</br></p>
<h3 id="BIC"><a href="#BIC" class="headerlink" title="BIC"></a>BIC</h3><p>按位与非运算指令。</br>逐位清除（立即数）对寄存器值和立即数的补码执行逐位“与”运算，并将结果写入目标寄存器。</br>相当于第二个操作数和第三个操作数取反之后取and</br>02 00 C1 E1                   BIC             R0, R1, R2（r0 &#x3D; r1 &amp; ~r2）</br></p>
<h3 id="ORR"><a href="#ORR" class="headerlink" title="ORR"></a>ORR</h3><p>按位或运算指令。</br>逐位OR（立即数）执行寄存器值和立即数的逐位（包括）OR，并将结果写入目标寄存器。</br>02 00 81 E1                   ORR             R0, R1, R2 （r0 &#x3D; r1 | r2）</br></p>
<h3 id="EOR"><a href="#EOR" class="headerlink" title="EOR"></a>EOR</h3><p>按位异或运算指令。</br>逐位异或（立即数）对寄存器值和立即数执行逐位异运算，并将结果写入目标寄存器。</br>02 00 21 E0                   EOR             R0, R1, R2（r0 &#x3D; r1 ^ r2）</br></p>
<h3 id="LSL"><a href="#LSL" class="headerlink" title="LSL"></a>LSL</h3><p>逻辑左移指令。</br>逻辑左移（立即数）将寄存器值左移立即数位，移位为零，并将结果写入目标寄存器。</br><br>lsl r0, r1, r2 </br>11 02 A0 E1                   MOV             R0, R1,LSL R2（r0 &#x3D; r1 &lt;&lt; r2）</br></p>
<h3 id="LSR"><a href="#LSR" class="headerlink" title="LSR"></a>LSR</h3><p>逻辑右移指令。</br>逻辑右移（立即数）将寄存器值右移一个立即数位数，移位为零，并将结果写入目标寄存器。</br><br>lsr r0, r1, r2</br>31 02 A0 E1                   MOV             R0, R1,LSR R2（r0 &#x3D; r1 &gt;&gt; r2）</br></p>
<h3 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a>ASR</h3><p>算术右移指令。</br>算术右移(立即数)将寄存器值右移立即位数，将其符号位的副本移位，并将结果写入目标寄存器。</br><br>asr r0, r1, r2</br>51 02 A0 E1                   MOV             R0, R1,ASR R2（r0 &#x3D; r1 &gt;&gt; r2）</br></p>
<h3 id="asr-r0-r1-r2和lsr-r0-r1-r2是一致的吗"><a href="#asr-r0-r1-r2和lsr-r0-r1-r2是一致的吗" class="headerlink" title="asr r0, r1, r2和lsr r0, r1, r2是一致的吗"></a>asr r0, r1, r2和lsr r0, r1, r2是一致的吗</h3><p>在一般情况下，asr r0, r1, r2 和 lsr r0, r1, r2 是不一致的。</br>asr r0, r1, r2 执行算术右移，将 r1 的所有位向右算术移动 r2 位，并将结果存储到 r0 中。算术右移在移位过程中用符号位填充左侧空出的位，即最高位（符号位）保持不变。</br>lsr r0, r1, r2 执行逻辑右移，将 r1 的所有位向右移动 r2 位，并将结果存储到 r0 中。逻辑右移在移位过程中用0填充左侧空出的位。</br>因此，在 asr 中，符号位会影响右移时左侧空出位的填充值，而在 lsr 中，左侧空出位总是用0填充。如果 r1 是一个带符号整数，asr 和 lsr 通常会得到不同的结果。</br></p>
<ul>
<li>举例：</br><ul>
<li>当考虑一个假设的8位寄存器的情况，其中最高位（MSB）表示符号（0表示正数，1表示负数）时，我们可以通过一个例子来说明 asr 和 lsr 的区别。</br></li>
</ul>
</li>
</ul>
<p>假设 r1 是二进制表示为 11011010，这是一个用二进制补码表示的负数。现在，让我们使用 asr 和 lsr 进行右移操作。</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">; 假设 r1 是 11011010（二进制表示），是一个负数</span><br><span class="line"></span><br><span class="line">asr r0, r1, #1  ; 算术右移 1 位</span><br><span class="line">; 经过 asr，r0 将变为 11110110（二进制表示），仍然是一个负数</span><br><span class="line"></span><br><span class="line">lsr r0, r1, #1  ; 逻辑右移 1 位</span><br><span class="line">; 经过 lsr，r0 将变为 01110101（二进制表示），是一个正数</span><br></pre></td></tr></table></figure>

<p>在这个例子中，asr 在右移过程中保留了符号位，导致结果仍然是负数。而 lsr 在填充左侧空出位时使用了 0，导致结果变为正数。这展示了算术右移和逻辑右移在处理符号位上的差异。</br></p>
<h2 id="访存指令"><a href="#访存指令" class="headerlink" title="访存指令"></a>访存指令</h2><p>访存：</br>LDR：从内存中加载数据到寄存器。</br>STR：将寄存器中的数据存储到内存。</br></p>
<p>1.数据流向</br>2.操作的寄存器和内存地址</br>3.后续附加行为 </br>块访存指令的语法是 {寄存器列表}，其中寄存器列表中的寄存器按照从右到左的顺序依次被处理。这意味着在执行块访存指令时，先处理列表中的最右边的寄存器，然后依次向左处理。</br></p>
<h3 id="LDR"><a href="#LDR" class="headerlink" title="LDR"></a>LDR</h3><p>加载寄存器（立即）从基本寄存器值和立即偏移中计算一个地址，从内存中加载单词，然后将其写入寄存器。 它可以使用偏移，索引或预先指定的地址。</br>04 00 91 E5                   LDR             R0, [R1,#4]</br>r1是一个基址寄存器，4是偏移量，表示从基址开始往后移动4个字节的位置。</br>也可以使用负偏移</br>04 00 11 E5                   LDR             R0, [R1,#-4]</br>02 00 91 E7                   LDR             R0, [R1,R2]</br>02 02 91 E7                   LDR             R0, [R1,R2,LSL#4]</br>上面指令都是没有后续附加行为的</br>04 00 B1 E5                   LDR             R0, [R1,#4]!  （加了!后除了把值写进r0，还会更新r1的地址，地址+4）</br><br>上述的指令都可以算是内偏移，还有外偏移的</br>04 00 91 E4                   LDR             R0, [R1],#4（从r1读出来的内存给r0后，后续行为把r1+4）</br></p>
<h3 id="STR"><a href="#STR" class="headerlink" title="STR"></a>STR</h3><p>存储寄存器(立即寄存器)根据基址寄存器值和立即偏移量计算地址，并将寄存器中的值存储到内存。它可以使用偏移量、后索引或前索引寻址。</br>0404 00 81 E4                  STR             R0, [R1],#4（将寄存器 R0 中的值存储到内存地址 R1 指向的位置，然后将 R1 的值递增 4（即地址加上 4））</br><br>可以使用LDR，STR来操作sp栈指针寄存器，达到pop和push的效果</br>当需要从sp取值到寄存器的时候，也就是pop，要用ldr，因为pop取值释放了空间，所以取值后sp栈指针要加4</br>而向sp放入值的时候，也就是push，要用str，因为push要分配空间，所以放值后sp栈指针要减4。</br>对于典型的栈操作，递减栈指针意味着在栈上分配一段新的空间，而递增栈指针则表示释放栈上的空间。在常见的体系结构中，栈是向低地址方向增长的，因此递减栈指针实际上是在向栈的底部分配空间。</br></p>
<ul>
<li><p>pop：</br></p>
<ul>
<li>LDR             R0, [SP], #4</br>    等同于下面两条</br>    ldr r1, [sp]         &#x2F;&#x2F; 从栈中加载值到寄存器 </br>    r1 add sp, sp, #4       &#x2F;&#x2F; 栈指针递增4个字节</br></li>
</ul>
</li>
<li><p>push:</br></p>
<ul>
<li>STR             R0, [SP, #-4]!</br>	等同于下面两条</br>sub sp, sp, #4       &#x2F;&#x2F; 栈指针递减4个字节 </br>str r0, [sp]         &#x2F;&#x2F; 将寄存器 r0 中的值存储到栈中</br></li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/10.webp"
                     
                ></br><br>ldr的12位立即数是0扩展的，只支持12位，第23位U是表示正负的，第24位P是表示内外偏移的。str也是同理</br></p>
<h2 id="块访存指令"><a href="#块访存指令" class="headerlink" title="块访存指令"></a>块访存指令</h2><p>块访存也是访存，读内存就是LDM开头，写内存STM开头，M表示多个数据或多个寄存器</br>当我们在使用LDM或STM指令时，是想加载或存储寄存器值之前还是之后增加或减少基址寄存器的值，这影响了加载或存储完成后基址寄存器的最终值。</br>LDM和STM指令可以跟随以下后缀：</br>IA，IB，DA，DB。第一个操作数后续还能加 ! ：表示在加载或存储完成后更新寄存器。</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/11.webp"
                     
                ></br><br>简单归纳就是</br>IA：访问这块指针后，再向后加4。</br>IB：还没访问这块指针，先向后加4，再访问。</br>DA：反向读4字节，然后减4</br>DB：先减4，然后再访问</br>  !表示最后指针的地址是否更新</br>常用只有LDMIA!，STMDB!，当第一个操作数为sp，等价于pop和push</br>再ida中指令为 stmdb sp!,{r0-r3} 会自动替换为</br>0F 00 2D E9                   PUSH            {R0-R3}</br>或</br>0F 00 2D E9                   STMFD           SP!, {R0-R3} </br>这两个是一样，在不同ida版本会显示不同</br>当第一个操作数是sp!时，ida会翻译成STMFD。第二个操作数无论是写 {R2,R1,R4,R3} 也会翻译成 {R1-R4}，寄存器标号小的放在低地址，寄存器标号大的放在高地址。</br>FD是用来操作栈的，当第一个操作数是sp时候，LDMFD等价于LDMIA，STMFD等价于STMDB。ida也会优先翻译为LDMFD，STMFD。当sp加了!后，则会优先翻译为POP和PUSH。</br></p>
<ul>
<li>例子：</br><ul>
<li>LDMIA SP, {R1-R4} &#x3D;&#x3D;&gt; LDMFD SP, {R1-R4}</br>    STMDB SP, {R1-R4} &#x3D;&#x3D;&#x3D;&gt; STMFD SP, {R1-R4}</br>    LDMIA SP!, {R1-R4} &#x3D;&#x3D;&gt; POP {R1-R4}</br>    STMDB SP!, {R1-R4} &#x3D;&#x3D;&gt; PUSH {R1-R4}</br></li>
</ul>
</li>
</ul>
<p>对于初学者先简单理解掌握下面三种</br>STMFD &#x3D;&#x3D; PUSH</br>LDMFD &#x3D;&#x3D; POP</br>***IA: 快速复制内存，根据前缀看是读还是写</br></p>
<h2 id="分支和模式切换"><a href="#分支和模式切换" class="headerlink" title="分支和模式切换"></a>分支和模式切换</h2><p>分支：B，BL，BX，BLX</br></p>
<ol>
<li>跳转目标</br>2. 模式切换，thumb和arm的切换</br>3. 写入LR的值</br></li>
</ol>
<p>后续是加立即数还是寄存器，分为以下几种情况：</br>B	imm</br>BL	imm</br>BX	reg</br>BLX	imm</br>BLX	reg</br></p>
<h3 id="B"><a href="#B" class="headerlink" title="B"></a>B</h3><p><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/12.webp"
                     
                ></br><br>B指令是无条件跳转，不带模式切换，T标志位不变。如果是从arm跳转thumb，或者thumb跳转到arm，需要保证跳转前后的模式统一。把指令机器码改为 00 00 00 EA，会发现要跳转的地址是当前地址+8，01 00 00 EA 则要跳转的地址是8+立即数<em>4（当前立即数为1）。如果是thumb模式下，则是8+立即数</em>2。</br>当00 00 00 EA会加8，那么FE FF FF EA 则是8+(-2*4)，即一直跳转到自己当前地址，进入死循环。</br>FE FF FF EA 需要记住，当一个进程很快执行结束的时候，又需要进行调试的时候。</br>用ida找到文件_start的地方，elf文件加载到内存中，_start是程序的入口点。可以同010 Editor对这个入口位置的指令修改为 FE FF FF EA。push到设备重新运行就断住了，再把指令改回来，就可以调试。</br>B指令的立即数可以寻址的范围是从当前指令的地址向前或向后移动的距离。由于立即数是相对偏移量，因此它可以覆盖的地址范围是从PC - 32MB到PC + 32MB。thumb模式下立即数只会更短</br></p>
<ul>
<li><p>例如：</br></p>
<ol>
<li>假设当前指令的地址是0x80000000（32位地址），并且B指令的立即数字段（imm24）的值为0x001234。将imm24与两个零（’00’）连接起来，得到一个32位的立即数：imm32 &#x3D; 0x00123400。</br></li>
<li>如果imm24是一个正数（无符号值），那么imm32的最高有效位将为零，扩展后的结果仍然是正数。例如，如果imm24的值为0x001234，那么imm32 &#x3D; 0x00123400。</br></li>
<li>如果imm24是一个负数（有符号值），那么imm32的最高有效位将为1，扩展后的结果仍然是负数。例如，如果imm24的值为0xFF1234，那么imm32 &#x3D; 0xFF123400。</br></li>
<li>将PC的当前值（0x80000000）与imm32进行相加，即PC + imm32，就可以得到B指令跳转的目标地址。目标地址为0x80000000 + 0x00123400 &#x3D; 0x80123400，根据前面提到的寻址范围，PC - 32MB到PC + 32MB是从0x7F800000到0x80000000+0x02000000的范围。在这个例子中，PC的当前值为0x80000000，而且目标地址0x80123400是在这个范围之内，因此B指令是可以正确寻址和跳转的。</br></li>
</ol>
</li>
</ul>
<h3 id="BL"><a href="#BL" class="headerlink" title="BL"></a>BL</h3><p>BL指令后面加立即数，也是无条件跳转，但是会写入LR的值。执行完会把bl指令的下一条指令的地址写入到LR。如果是在thumb下，会把bl下一条指令的地址异或T位，也就是1，地址会变成奇数写入LR。当程序需要返回的时候通过LR的最低位来返回arm模式还是thumb模式，0就是arm，1就是thumb。</br></p>
<h3 id="BX"><a href="#BX" class="headerlink" title="BX"></a>BX</h3><p>BX指令后面加寄存器，BX会把寄存器的值拆成两部分，最低位会写入T标志位，用于指示跳转的目标指令集，剩余的部分写入pc寄存器，作为跳转的目标地址。通俗点就是如果地址是奇数，最低位就是1，偶数则是0。T标志位用于指示跳转目标的指令集，0表示ARM指令集，1表示Thumb指令集。</br></p>
<h3 id="BLX"><a href="#BLX" class="headerlink" title="BLX"></a>BLX</h3><p>有两种情况，立即数和寄存器。</br>BLX+立即数是一定会带有模式切换的，并会把执行完会把blx指令的下一条指令的地址写入到LR，把当前T标志位写入LR值的最低位后再更新T标志的值。</br>BLX+寄存器跟BX+寄存器一样，会把执行完会把blx指令的下一条指令的地址写入到LR，是否模式切换以及T标志的值看寄存器地址的最低位。</br></p>
<h3 id="使用mov跳转"><a href="#使用mov跳转" class="headerlink" title="使用mov跳转"></a>使用mov跳转</h3><p>跟BX reg做对比， mov pc, r0 指令将会直接将寄存器 R0 的值复制到程序计数器 PC，这意味着它是一个非条件的直接分支，不会进行任何模式切换，而且不会修改 T 标志位。</br></p>
<h3 id="使用ldr跳转"><a href="#使用ldr跳转" class="headerlink" title="使用ldr跳转"></a>使用ldr跳转</h3><p>直接从内存加载地址到pc， ldr pc, [r0]，把r0寄存器指向的值给pc，这种也会根据寄存器的值奇偶数来切换模式，并更新T标志位。</br>有三种跳转指令 B系列指令，mov，ldr。其中mov最弱，不带有模式切换，一般也很少用。</br>ldr指令调用一个导入表的方法</br></p>
<h3 id="判断导出表函数的模式"><a href="#判断导出表函数的模式" class="headerlink" title="判断导出表函数的模式"></a>判断导出表函数的模式</h3><p>怎么判断导出表的函数时arm模式还是thumb模式？</br>再ida中查看libc的导出表函数时，address都是偶数，难道全都是arm模式吗？比如printf函数，地址是偶数，点击进去又是thumb指令。那在其它文件调用这个导出表函数时，如何正确知道函数是哪种模式？</br>readelf -s libc.so &gt; a.txt</br>可以显示库的所有导出符号表，</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">   657: 0001e775    36 FUNC    GLOBAL DEFAULT    7 printf</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>下面是在ida中的地址<br>!<img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/13.webp"
                     
                ></br><br>在ida中的地址是1e774，通过readelf的地址是1e775，所以就能判断出printf是thumb模式的，在调用printf的时候，会把拆成两部分，最低位写入T标志位，跳转的时候自动模式切换了。</br>这也就解释了在使用frida在hook thumb函数地址的时候为什么要加1了。</br></p>
<h2 id="Thumb模式"><a href="#Thumb模式" class="headerlink" title="Thumb模式"></a>Thumb模式</h2><p>在thumb下短指令也就是2字节的指令一般不使用r8-r12寄存器，如果使用了就会编译为长指令。</br>一般也没有条件码和标志响应位，运算指令优先对第一，第二操作数相同情况下用短指令编码，以提高代码密度。这种优化可以减少指令数量和代码大小。</br>比如：add r0, r0, r1 会自动转为 add r0, r1</br>还有一些情况当短指令编码编译不过的时候编译器会在指令后缀+.w进行4字节指令编码。</br>add.w r0, r0, r1</br></p>
<h3 id="IT指令块"><a href="#IT指令块" class="headerlink" title="IT指令块"></a>IT指令块</h3><p>IT 指令是 Thumb 指令集中的一种条件执行指令，用于在紧接着的多条指令中根据条件选择性地执行。IT 指令块由一个条件码和最多四条紧接着的指令组成，它们构成了一个条件执行块。在条件执行块中，只有在满足条件时才会执行相应的指令。</br>IT 指令的格式如下：</br>IT{&lt;x&gt;{&lt;y&gt;{&lt;z&gt;}}}{&lt;q&gt;} &lt;cond&gt;</br><br><img  
                     lazyload
                     alt="image"
                     data-src="https://jsd.cdn.zzko.cn/gh/Zskkk/blog-images@master/20230901/14.webp"
                     
                ></br><br>IT 指令块由可选的后缀（x, y, z）和一个可选的条件码（q）组成。 </br>后缀 x, y, z 分别指示条件执行块中的第一条、第二条和第三条指令。</br> &lt;q&gt; 是可选的条件码，用于指定条件执行块的执行条件。 如果条件码 &lt;q&gt; 不存在，则默认情况下，IT 指令块中的所有指令都受到相同的条件码 <cond> 控制。</br>T表示if，E表示else</br>05 BF	ITTET EQ</br>01 20	MOVEQ R0, #1</br>02 21	MOVEQ R1, #2</br>03 22	MOVS R2, #3</br>04 23	MOVSEQ R3, #4</br>在ida中比如指令 movs r0, #1 如果处于IT指令块里面，会自动给加上条件码。</br>假如这段指令当前的Z标志位是0，那EQ条件就不成立</br>it指令块下的第一条指令跟条件码EQ的条件一样的，不执行</br>it指令块下的第二条指令是看IT后面第一位是T，那也就是跟EQ的条件一样，不执行</br>it指令块下的第三条指令是看IT后面第二位是E，跟EQ的条件相反，执行</br>第四条是T，不执行</br></p>
<h2 id="调用约定和栈帧分析"><a href="#调用约定和栈帧分析" class="headerlink" title="调用约定和栈帧分析"></a>调用约定和栈帧分析</h2><h3 id="调用约定"><a href="#调用约定" class="headerlink" title="调用约定"></a>调用约定</h3><p>前4个参数：r0-r3，其他参数栈传递</br>非易变寄存器：r4-r11</br><br>r11: 栈帧指针</br>r12: 导入表寻址</br>测试代码，使用ndk build后用ida打开</br></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fun</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d, <span class="type">int</span> e, <span class="type">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = d + e;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, n);</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">fun</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="前4个参数"><a href="#前4个参数" class="headerlink" title="前4个参数"></a>前4个参数</h3><p>前4个参数通常会被依次传递到寄存器 R0 到 R3 中。这样设计的原因是为了尽可能地利用寄存器，以提高函数调用的效率。如果函数需要的参数超过4个，那么额外的参数就会被放置在栈上。</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">.text:00000628                               ; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:00000628                               EXPORT main</span><br><span class="line">.text:00000628                               main                                    ; DATA XREF: .text:0000057C↑o</span><br><span class="line">.text:00000628                               ; __unwind &#123;</span><br><span class="line">.text:00000628 00 48 2D E9                   PUSH            &#123;R11,LR&#125;</span><br><span class="line">.text:0000062C 0D B0 A0 E1                   MOV             R11, SP</span><br><span class="line">.text:00000630 10 D0 4D E2                   SUB             SP, SP, #0x10</span><br><span class="line">.text:00000634 00 00 00 E3                   MOVW            R0, #0</span><br><span class="line">.text:00000638 04 00 0B E5                   STR             R0, [R11,#-4]</span><br><span class="line">.text:0000063C 01 00 00 E3                   MOVW            R0, #1                  ; a 参数1放到寄存器r0</span><br><span class="line">.text:00000640 02 10 00 E3                   MOVW            R1, #2                  ; b 参数2放到寄存器r1</span><br><span class="line">.text:00000644 03 20 00 E3                   MOVW            R2, #3                  ; c 参数3放到寄存器r2</span><br><span class="line">.text:00000648 04 30 00 E3                   MOVW            R3, #4                  ; d 参数4放到寄存器r3</span><br><span class="line">.text:0000064C 05 C0 00 E3                   MOVW            R12, #5</span><br><span class="line">.text:00000650 00 C0 8D E5                   STR             R12, [SP]               ; e 参数5先放在r12，在从r12读取放到sp上</span><br><span class="line">.text:00000654 06 C0 00 E3                   MOVW            R12, #6</span><br><span class="line">.text:00000658 04 C0 8D E5                   STR             R12, [SP,#4]            ; f 参数6先放在r12，在从r12读取放在sp+4上</span><br><span class="line">.text:0000065C D7 FF FF EB                   BL              fun</span><br><span class="line">.text:0000065C</span><br><span class="line">.text:00000660 00 10 00 E3                   MOVW            R1, #0</span><br><span class="line">.text:00000664 08 00 8D E5                   STR             R0, [SP,#8]</span><br><span class="line">.text:00000668 01 00 A0 E1                   MOV             R0, R1</span><br><span class="line">.text:0000066C 0B D0 A0 E1                   MOV             SP, R11</span><br><span class="line">.text:00000670 00 88 BD E8                   POP             &#123;R11,PC&#125;</span><br><span class="line">.text:00000670                               ; &#125; // starts at 628</span><br><span class="line">.text:00000670</span><br><span class="line">.text:00000670                               ; End of function main</span><br></pre></td></tr></table></figure>
<h3 id="非易变寄存器"><a href="#非易变寄存器" class="headerlink" title="非易变寄存器"></a>非易变寄存器</h3><p>在 ARM 架构中，寄存器 R4 到 R11 被称为非易失性寄存器，通常用于存储在函数调用期间需要被保留的临时数据，因此，如果一个函数在调用期间修改了这些寄存器的值，它必须在返回之前恢复这些寄存器的原始值，以确保调用者的寄存器值不会被破坏。</br></p>
<h3 id="栈帧指针"><a href="#栈帧指针" class="headerlink" title="栈帧指针"></a>栈帧指针</h3><p>在 ARM 架构中，寄存器 R11 通常被用作栈帧指针，栈帧指针是一个指向当前函数栈帧的指针，栈帧是在函数调用期间分配的一块内存区域，用于存储局部变量、函数参数、返回地址等信息。 通常情况下，当一个函数被调用时，它会在栈上创建一个新的栈帧，并将栈帧指针指向这个新的栈帧。在函数内部，通过栈帧指针可以方便地访问栈帧中的局部变量和参数。而当函数返回时，栈帧指针会被恢复到上一个函数的栈帧，以便正确地返回到调用函数。</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">.text:000005C0                               ; int fun(int a, int b, int c, int d, int e, int f)</span><br><span class="line">.text:000005C0                               EXPORT fun</span><br><span class="line">.text:000005C0                               fun                                     ; CODE XREF: main+34↓p</span><br><span class="line">.text:000005C0                               ; __unwind &#123;</span><br><span class="line">.text:000005C0 10 4C 2D E9                   PUSH            &#123;R4,R10,R11,LR&#125;</span><br><span class="line">.text:000005C4 08 B0 8D E2                   ADD             R11, SP, #8</span><br><span class="line">.text:000005C8 20 D0 4D E2                   SUB             SP, SP, #0x20</span><br><span class="line">.text:000005CC 0C C0 9B E5                   LDR             R12, [R11,#f]</span><br><span class="line">.text:000005D0 08 E0 9B E5                   LDR             LR, [R11,#e]</span><br><span class="line">.text:000005D4 48 40 9F E5                   LDR             R4, =0x1B0</span><br><span class="line">.text:000005D8 04 40 8F E0                   ADD             R4, PC, R4              ; &quot;%d\n&quot;</span><br><span class="line">.text:000005DC 0C 00 0B E5                   STR             R0, [R11,#-0xC]</span><br><span class="line">.text:000005E0 10 10 0B E5                   STR             R1, [R11,#-0x10]</span><br><span class="line">.text:000005E4 14 20 8D E5                   STR             R2, [SP,#0x14]</span><br><span class="line">.text:000005E8 10 30 8D E5                   STR             R3, [SP,#0x10]</span><br><span class="line">.text:000005EC 10 00 9D E5                   LDR             R0, [SP,#0x10]</span><br><span class="line">.text:000005F0 08 10 9B E5                   LDR             R1, [R11,#e]</span><br><span class="line">.text:000005F4 01 00 80 E0                   ADD             R0, R0, R1</span><br><span class="line">.text:000005F8 0C 00 8D E5                   STR             R0, [SP,#0xC]</span><br><span class="line">.text:000005FC 0C 10 9D E5                   LDR             R1, [SP,#0xC]</span><br><span class="line">.text:00000600 04 00 A0 E1                   MOV             R0, R4                  ; format</span><br><span class="line">.text:00000604 08 C0 8D E5                   STR             R12, [SP,#8]</span><br><span class="line">.text:00000608 04 E0 8D E5                   STR             LR, [SP,#4]</span><br><span class="line">.text:0000060C C3 FF FF EB                   BL              printf</span><br><span class="line">.text:0000060C</span><br><span class="line">.text:00000610 0C 10 9D E5                   LDR             R1, [SP,#0xC]</span><br><span class="line">.text:00000614 00 00 8D E5                   STR             R0, [SP]</span><br><span class="line">.text:00000618 01 00 A0 E1                   MOV             R0, R1</span><br><span class="line">.text:0000061C 08 D0 4B E2                   SUB             SP, R11, #8</span><br><span class="line">.text:00000620 10 8C BD E8                   POP             &#123;R4,R10,R11,PC&#125;</span><br><span class="line">.text:00000620</span><br><span class="line">.text:00000620                               ; End of function fun</span><br></pre></td></tr></table></figure>
<p>函数开头</br>PUSH            {R11,LR}</br>MOV             R11, SP</br>这两条指令是函数开头的典型指令序列，通常用于建立函数的栈帧。这里的操作可以理解为：</br>PUSH {R11, LR}：将当前函数的栈帧指针 R11 和返回地址 LR 压入栈中。这是为了保存这两个寄存器的值，以便函数执行完毕后能够正确地恢复到函数调用前的状态。 </br>MOV R11, SP：将当前栈指针 SP 的值复制到 R11 中。这样做是为了在函数中能够方便地访问栈帧中的局部变量和其他信息。通常情况下，函数的局部变量和参数会相对于栈帧指针来进行访问。 通过这两条指令的组合，函数建立了自己的栈帧，并将栈帧指针存储在 R11 中，以便在函数内部能够轻松地访问栈上的数据。</br>函数结尾</br>MOV             SP, R11  将栈帧指针 R11 的值赋给栈指针 SP，恢复栈指针到函数调用前的状态。</br>POP             {R11,PC} 从栈中依次弹出 R11 和 PC 寄存器的值。</br></p>
<h3 id="导入表寻址"><a href="#导入表寻址" class="headerlink" title="导入表寻址"></a>导入表寻址</h3><p>R12 寄存器用于进行导入表寻址。导入表是一个数据结构，存储了函数的地址或函数指针。在动态链接库（DLL）或共享库中，当程序调用一个外部函数时，需要在运行时动态解析函数的地址，这就需要导入表。</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.plt:00000520                               ; int printf(const char *format, ...)</span><br><span class="line">.plt:00000520                               printf                                  ; CODE XREF: fun+4C↓p</span><br><span class="line">.plt:00000520 00 C6 8F E2                   ADR             R12, 0x528</span><br><span class="line">.plt:00000524 01 CA 8C E2                   ADD             R12, R12, #0x1000</span><br><span class="line">.plt:00000528 D0 FA BC E5                   LDR             PC, [R12,#(printf_ptr - 0x1528)]! ; __imp_printf</span><br><span class="line">.plt:00000528</span><br><span class="line">.plt:00000528                               ; End of function printf</span><br></pre></td></tr></table></figure>

<p>注意：函数的返回值是放在R0里的</br>下面是根据上面反汇编模拟执行的栈指针，根据执行main和fun函数的栈地址偏移表示如下：</br></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$-30 |	ret_printf		&lt;-- sp fun</span><br><span class="line">$-2C |	5   (LDR LR, [R11,#8]，STR LR, [SP,#4]，将R11+0x8的值放到这)</span><br><span class="line">$-28 |	6	(LDR R12, [R11,#0xC], STR R12, [SP,#8]，将R11+0xC的值放到这)</span><br><span class="line">$-24 |	9（n）   (LDR R0, [SP,#0x10], LDR R1, [R11,#8], ADD R0, R0, R1，将$-20和$的值4+5放到这)</span><br><span class="line">$-20 |	R3</span><br><span class="line">$-1C |	R2</span><br><span class="line">$-18 |	R1</span><br><span class="line">$-14 |	R0</span><br><span class="line">$-10 |	R4</span><br><span class="line">$-C  |	R10</span><br><span class="line">$-8  |	R11			&lt;-- R11, 前一个函数main函数R11的位置</span><br><span class="line">$-4  |	LR</span><br><span class="line">$==&gt; |	5			&lt;-- sp main / fun in			</span><br><span class="line">$+4  |	6</span><br><span class="line">$+8  |	ret_fun</span><br><span class="line">$+C  |	0</span><br><span class="line">$+10 |	R11			&lt;-- R11,前一个函数R11的位置</span><br><span class="line">$+14 |	LR</span><br><span class="line">$+18 |				&lt;-- main函数里栈指针稳定时候的位置，main in 0x4+0x4+0x10</span><br><span class="line">$+1C |</span><br><span class="line">$+20 |</span><br><span class="line">$+24 |</span><br><span class="line">$+28 |</span><br><span class="line">$+2C |</span><br><span class="line">$+30 |</span><br></pre></td></tr></table></figure>


                </div>

                
                        <div class="article-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="post-title border-box text-ellipsis">
                Arm汇编
            </div>

            <div class="post-link border-box text-ellipsis">
                posts/22788/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="post-author bottom-item">
                <div class="type">
                    作者
                </div>
                <div class="content">zsk</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    发布于
                </div>
                <div class="content">2023-09-01 00:00</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    许可
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">
                        <i class="fa-brands fa-creative-commons"></i>
                        <i class="fa-brands fa-creative-commons-by"></i>
                        <i class="fa-brands fa-creative-commons-nc"></i>
                        <i class="fa-brands fa-creative-commons-sa"></i>
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="复制版权信息" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/ARM/">ARM</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                            <div class="post-share-container border-box">
    <ul class="share-list-wrap border-box">
        <li class="qq share-item border-box flex-center tooltip"
            data-tooltip-content="分享到 QQ"
        >
            <i class="fa-brands fa-qq"></i>
        </li>
        <li class="wechat share-item border-box flex-center tooltip tooltip-img"
            data-tooltip-content="分享到微信"
            data-tooltip-img-tip="微信扫一扫"
            data-tooltip-img-style="background-color: #fff; top: -10px; padding: 0.6rem 0.6rem 0.1rem 0.6rem;"
        >
            <i class="fa-brands fa-weixin"></i>
        </li>
        <li class="weibo share-item border-box flex-center tooltip"
            data-tooltip-content="分享到微博"
        >
            <i class="fa-brands fa-weibo"></i>
        </li>
    </ul>
</div>

                        
                    </div>
                </div>

                

                
                    <div class="article-nav">
                        
                            <div class="article-prev">
                                <a class="prev"
                                   rel="prev"
                                   href="/posts/4118/"
                                   title="Ubuntu18.04 编译安卓6.0刷入Nexus 5"
                                >
                                    <span class="left arrow-icon flex-center">
                                      <i class="fas fa-chevron-left"></i>
                                    </span>
                                            <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Ubuntu18.04 编译安卓6.0刷入Nexus 5</span>
                                        <span class="post-nav-item">上一篇</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="article-next">
                                <a class="next"
                                   rel="next"
                                   href="/posts/16537/"
                                   title="某音web端X-Bogus 逆向分析算法"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">某音web端X-Bogus 逆向分析算法</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                            <span class="right arrow-icon flex-center">
                                      <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;评论
        </div>
        
            

    <div class="valine-container">
        <script data-pjax src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
          function loadValine() {

            const config = {
              el: '#vcomments',
              appId: 'WxNQs5QEQtykF82Sb7nAjXRO-gzGzoHsz',
              appKey: '4rZ6NwH5zAu6VEspHwVrgqOq',
              meta: ['nick', 'mail', 'link'],
              avatar: 'wavatar',
              enableQQ: true,
              placeholder: '😜 尽情吐槽吧~',
              lang: 'zh-CN'.toLowerCase()
            }

            if ('') {
              config.serverURLs = ''
            }

            new Valine(config)

            function getAuthor(language) {
              switch (language) {
                case 'en':
                  return 'Author'
                case 'zh-CN':
                  return '博主'
                case 'zh-TW':
                  return '站長'
                default:
                  return 'Master'
              }
            }

            // Add "Author" identify
            const getValineDomTimer = setInterval(() => {
              const vcards = document.querySelectorAll('#vcomments .vcards .vcard')
              if (vcards.length > 0) {
                let author = 'zsk'

                if (author) {
                  for (let vcard of vcards) {
                    const vnick_dom = vcard.querySelector('.vhead .vnick')
                    const vnick = vnick_dom.innerHTML
                    if (vnick === author) {
                      vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                    }
                  }
                }
                clearInterval(getValineDomTimer)
              } else {
                clearInterval(getValineDomTimer)
              }
            }, 2000)
          }

          if ('true' === 'true') {
            const loadValineTimeout = setTimeout(() => {
              loadValine()
              clearTimeout(loadValineTimeout)
            }, 1000)
          } else {
            window.addEventListener('DOMContentLoaded', loadValine)
          }
        </script>
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-number">1.</span> <span class="nav-text">环境搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#c%E6%96%87%E4%BB%B6%E7%BC%96%E8%AF%91%E6%88%90arm%E8%BF%90%E8%A1%8C"><span class="nav-number">2.</span> <span class="nav-text">c文件编译成arm运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ida%E8%B0%83%E8%AF%95"><span class="nav-number">3.</span> <span class="nav-text">ida调试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8C%E6%8C%87%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%A0%BC%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">寄存器和指令基本格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E5%92%8C%E6%A0%87%E5%BF%97%E4%BD%8D%E5%93%8D%E5%BA%94"><span class="nav-number">5.</span> <span class="nav-text">条件和标志位响应</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%8C%87%E4%BB%A4"><span class="nav-number">5.1.</span> <span class="nav-text">条件指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MOV%E6%8C%87%E4%BB%A4"><span class="nav-number">6.</span> <span class="nav-text">MOV指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AB%8B%E5%8D%B3%E6%95%B0"><span class="nav-number">6.1.</span> <span class="nav-text">立即数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">6.2.</span> <span class="nav-text">寄存器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">6.3.</span> <span class="nav-text">寄存器移位寄存器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B4%E5%9E%8B%E8%BF%90%E7%AE%97"><span class="nav-number">7.</span> <span class="nav-text">基本整型运算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ADD-ADDS-immediate"><span class="nav-number">7.1.</span> <span class="nav-text">ADD, ADDS (immediate)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ADD-ADDS-register"><span class="nav-number">7.2.</span> <span class="nav-text">ADD, ADDS (register)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ADR"><span class="nav-number">7.3.</span> <span class="nav-text">ADR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SUB"><span class="nav-number">7.4.</span> <span class="nav-text">SUB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RSB"><span class="nav-number">7.5.</span> <span class="nav-text">RSB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AND"><span class="nav-number">7.6.</span> <span class="nav-text">AND</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BIC"><span class="nav-number">7.7.</span> <span class="nav-text">BIC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ORR"><span class="nav-number">7.8.</span> <span class="nav-text">ORR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EOR"><span class="nav-number">7.9.</span> <span class="nav-text">EOR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LSL"><span class="nav-number">7.10.</span> <span class="nav-text">LSL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LSR"><span class="nav-number">7.11.</span> <span class="nav-text">LSR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ASR"><span class="nav-number">7.12.</span> <span class="nav-text">ASR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#asr-r0-r1-r2%E5%92%8Clsr-r0-r1-r2%E6%98%AF%E4%B8%80%E8%87%B4%E7%9A%84%E5%90%97"><span class="nav-number">7.13.</span> <span class="nav-text">asr r0, r1, r2和lsr r0, r1, r2是一致的吗</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BF%E5%AD%98%E6%8C%87%E4%BB%A4"><span class="nav-number">8.</span> <span class="nav-text">访存指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LDR"><span class="nav-number">8.1.</span> <span class="nav-text">LDR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#STR"><span class="nav-number">8.2.</span> <span class="nav-text">STR</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9D%97%E8%AE%BF%E5%AD%98%E6%8C%87%E4%BB%A4"><span class="nav-number">9.</span> <span class="nav-text">块访存指令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8D%A2"><span class="nav-number">10.</span> <span class="nav-text">分支和模式切换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#B"><span class="nav-number">10.1.</span> <span class="nav-text">B</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BL"><span class="nav-number">10.2.</span> <span class="nav-text">BL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BX"><span class="nav-number">10.3.</span> <span class="nav-text">BX</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BLX"><span class="nav-number">10.4.</span> <span class="nav-text">BLX</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mov%E8%B7%B3%E8%BD%AC"><span class="nav-number">10.5.</span> <span class="nav-text">使用mov跳转</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8ldr%E8%B7%B3%E8%BD%AC"><span class="nav-number">10.6.</span> <span class="nav-text">使用ldr跳转</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E5%AF%BC%E5%87%BA%E8%A1%A8%E5%87%BD%E6%95%B0%E7%9A%84%E6%A8%A1%E5%BC%8F"><span class="nav-number">10.7.</span> <span class="nav-text">判断导出表函数的模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Thumb%E6%A8%A1%E5%BC%8F"><span class="nav-number">11.</span> <span class="nav-text">Thumb模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IT%E6%8C%87%E4%BB%A4%E5%9D%97"><span class="nav-number">11.1.</span> <span class="nav-text">IT指令块</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A%E5%92%8C%E6%A0%88%E5%B8%A7%E5%88%86%E6%9E%90"><span class="nav-number">12.</span> <span class="nav-text">调用约定和栈帧分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A"><span class="nav-number">12.1.</span> <span class="nav-text">调用约定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D4%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="nav-number">12.2.</span> <span class="nav-text">前4个参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E6%98%93%E5%8F%98%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">12.3.</span> <span class="nav-text">非易变寄存器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%88%E5%B8%A7%E6%8C%87%E9%92%88"><span class="nav-number">12.4.</span> <span class="nav-text">栈帧指针</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E8%A1%A8%E5%AF%BB%E5%9D%80"><span class="nav-number">12.5.</span> <span class="nav-text">导入表寻址</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="border-box website-info-box default">
        
            <div class="copyright-info info-item default">
                &copy;&nbsp;<span>2021</span>&nbsp;-&nbsp;2024
                
                    &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">zsk</a>
                
            </div>

            <div class="theme-info info-item default">
                由&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;驱动&nbsp;&&nbsp;主题&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
            </div>

            

            
                <div class="deploy-info info-item default">
                    
                        本站由 <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/deploy-provider/github.png"></span> 提供部署服务
                        
                </div>
            
        

        <div class="count-item info-item default">
            
                <span class="count-box border-box word">
                    <span class="item-type border-box">总字数</span>
                    <span class="item-value border-box word">96.9k</span>
                </span>
            

            
                <span class="count-box border-box uv">
                    <span class="item-type border-box">访客数</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-box border-box pv">
                    <span class="item-type border-box">访问量</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    </div>
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="tools-list border-box">
        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-number">1.</span> <span class="nav-text">环境搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#c%E6%96%87%E4%BB%B6%E7%BC%96%E8%AF%91%E6%88%90arm%E8%BF%90%E8%A1%8C"><span class="nav-number">2.</span> <span class="nav-text">c文件编译成arm运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ida%E8%B0%83%E8%AF%95"><span class="nav-number">3.</span> <span class="nav-text">ida调试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8C%E6%8C%87%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%A0%BC%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">寄存器和指令基本格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E5%92%8C%E6%A0%87%E5%BF%97%E4%BD%8D%E5%93%8D%E5%BA%94"><span class="nav-number">5.</span> <span class="nav-text">条件和标志位响应</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%8C%87%E4%BB%A4"><span class="nav-number">5.1.</span> <span class="nav-text">条件指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MOV%E6%8C%87%E4%BB%A4"><span class="nav-number">6.</span> <span class="nav-text">MOV指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AB%8B%E5%8D%B3%E6%95%B0"><span class="nav-number">6.1.</span> <span class="nav-text">立即数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">6.2.</span> <span class="nav-text">寄存器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">6.3.</span> <span class="nav-text">寄存器移位寄存器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B4%E5%9E%8B%E8%BF%90%E7%AE%97"><span class="nav-number">7.</span> <span class="nav-text">基本整型运算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ADD-ADDS-immediate"><span class="nav-number">7.1.</span> <span class="nav-text">ADD, ADDS (immediate)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ADD-ADDS-register"><span class="nav-number">7.2.</span> <span class="nav-text">ADD, ADDS (register)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ADR"><span class="nav-number">7.3.</span> <span class="nav-text">ADR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SUB"><span class="nav-number">7.4.</span> <span class="nav-text">SUB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RSB"><span class="nav-number">7.5.</span> <span class="nav-text">RSB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AND"><span class="nav-number">7.6.</span> <span class="nav-text">AND</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BIC"><span class="nav-number">7.7.</span> <span class="nav-text">BIC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ORR"><span class="nav-number">7.8.</span> <span class="nav-text">ORR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EOR"><span class="nav-number">7.9.</span> <span class="nav-text">EOR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LSL"><span class="nav-number">7.10.</span> <span class="nav-text">LSL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LSR"><span class="nav-number">7.11.</span> <span class="nav-text">LSR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ASR"><span class="nav-number">7.12.</span> <span class="nav-text">ASR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#asr-r0-r1-r2%E5%92%8Clsr-r0-r1-r2%E6%98%AF%E4%B8%80%E8%87%B4%E7%9A%84%E5%90%97"><span class="nav-number">7.13.</span> <span class="nav-text">asr r0, r1, r2和lsr r0, r1, r2是一致的吗</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BF%E5%AD%98%E6%8C%87%E4%BB%A4"><span class="nav-number">8.</span> <span class="nav-text">访存指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LDR"><span class="nav-number">8.1.</span> <span class="nav-text">LDR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#STR"><span class="nav-number">8.2.</span> <span class="nav-text">STR</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9D%97%E8%AE%BF%E5%AD%98%E6%8C%87%E4%BB%A4"><span class="nav-number">9.</span> <span class="nav-text">块访存指令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8D%A2"><span class="nav-number">10.</span> <span class="nav-text">分支和模式切换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#B"><span class="nav-number">10.1.</span> <span class="nav-text">B</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BL"><span class="nav-number">10.2.</span> <span class="nav-text">BL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BX"><span class="nav-number">10.3.</span> <span class="nav-text">BX</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BLX"><span class="nav-number">10.4.</span> <span class="nav-text">BLX</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mov%E8%B7%B3%E8%BD%AC"><span class="nav-number">10.5.</span> <span class="nav-text">使用mov跳转</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8ldr%E8%B7%B3%E8%BD%AC"><span class="nav-number">10.6.</span> <span class="nav-text">使用ldr跳转</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E5%AF%BC%E5%87%BA%E8%A1%A8%E5%87%BD%E6%95%B0%E7%9A%84%E6%A8%A1%E5%BC%8F"><span class="nav-number">10.7.</span> <span class="nav-text">判断导出表函数的模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Thumb%E6%A8%A1%E5%BC%8F"><span class="nav-number">11.</span> <span class="nav-text">Thumb模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IT%E6%8C%87%E4%BB%A4%E5%9D%97"><span class="nav-number">11.1.</span> <span class="nav-text">IT指令块</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A%E5%92%8C%E6%A0%88%E5%B8%A7%E5%88%86%E6%9E%90"><span class="nav-number">12.</span> <span class="nav-text">调用约定和栈帧分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A"><span class="nav-number">12.1.</span> <span class="nav-text">调用约定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D4%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="nav-number">12.2.</span> <span class="nav-text">前4个参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E6%98%93%E5%8F%98%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">12.3.</span> <span class="nav-text">非易变寄存器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%88%E5%B8%A7%E6%8C%87%E9%92%88"><span class="nav-number">12.4.</span> <span class="nav-text">栈帧指针</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E8%A1%A8%E5%AF%BB%E5%9D%80"><span class="nav-number">12.5.</span> <span class="nav-text">导入表寻址</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>



<!-- common -->
<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/libs/anime.min.js"></script>

<!-- local-search -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/local-search.js"></script>


<!-- code-block -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/code-block.js"></script>


<!-- lazyload -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/lazyload.js"></script>


<div class="pjax">
    
        <!-- post-helper -->
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/post-helper.js"></script>

        <!-- toc -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/toc.js"></script>
        

        <!-- copyright-info -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/copyright-info.js"></script>
        

        <!-- share -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/post/share.js"></script>
        
    

    <!-- category-page -->
    

    <!-- links-page -->
    
</div>

<!-- pjax -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart()
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd()
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'))
            KEEP.initExecute()
        });
    });
</script>




    
        
    
        
            
<script class="custom-inject-js" src="/js/custom-1.js" data-pjax></script>

        
    

</body>
</html>
